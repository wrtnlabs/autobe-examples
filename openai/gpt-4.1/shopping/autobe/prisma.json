{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"shopping_mall_categories","description":"Hierarchical category tree table for organizing all products, collections, and search facets. Supports multilingual category names/descriptions. Self-referencing for parent/child, root categories have null parent_id. Used platform-wide for all systems referencing categories (products, catalogs, navigation, admin tools). Enforces unique category names within a parent for each language. Fast text search and hierarchical queries supported. All changes trigger global cache invalidation. {@link shopping_mall_categories.id}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"parent_id","type":"uuid","description":"Optional parent category's {@link shopping_mall_categories.id}. Root categories have null parent_id.","relation":{"name":"parent","targetModel":"shopping_mall_categories","mappingName":"recursive"},"unique":false,"nullable":true}],"plainFields":[{"name":"name_ko","type":"string","description":"Category name in Korean. Required for localization support. Unique within parent category.","nullable":false},{"name":"name_en","type":"string","description":"Category name in English. Required for localization support. Unique within parent category.","nullable":false},{"name":"description_ko","type":"string","description":"Category description in Korean. Optional for longer text or category explanation.","nullable":true},{"name":"description_en","type":"string","description":"Category description in English. Optional for longer text or category explanation.","nullable":true},{"name":"display_order","type":"int","description":"Ordering index for display in navigation, 0-based. Allows admin sorting of sibling categories.","nullable":false},{"name":"is_active","type":"boolean","description":"Whether the category is active/enabled across platform. Inactive disables all subcategories and associated products.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp (for cache invalidation, reindex triggers).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-delete timestamp. Null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["parent_id","name_ko"],"unique":true},{"fieldNames":["parent_id","name_en"],"unique":true}],"plainIndexes":[{"fieldNames":["parent_id","display_order"]}],"ginIndexes":[{"fieldName":"name_ko"},{"fieldName":"name_en"}]},{"name":"shopping_mall_system_configs","description":"System configuration key-value store for all dynamic runtime settings and feature toggles. Managed directly by platform admins via API or dashboard. Every config is uniquely identified by a (key, scope) pair, supports value typing for safe retrieval, and audit trails for changes. Used for feature flags, 3rd party credentials, rate limits, operational switches, and critical platform customizations. No cross-domain dependencies. {@link shopping_mall_system_configs.id}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"config_key","type":"string","description":"System-wide unique config key (case-insensitive, e.g. 'enable_payments', 'max_cart_size').","nullable":false},{"name":"config_scope","type":"string","description":"Config scope (e.g., 'global', 'payment', 'product', 'review'). Modularizes config space. Required for namespacing.","nullable":false},{"name":"value_type","type":"string","description":"Stored value type for this config (e.g., 'string', 'int', 'boolean', 'json'). Used for proper dynamic retrieval.","nullable":false},{"name":"string_value","type":"string","description":"String value for configs whose data type is string. Nullable for non-string/configs.","nullable":true},{"name":"int_value","type":"int","description":"Int value for configs whose data type is integer. Nullable for non-integer/configs.","nullable":true},{"name":"double_value","type":"double","description":"Double value for configs whose data type is double (e.g. percentages, rates). Nullable for non-double/configs.","nullable":true},{"name":"boolean_value","type":"boolean","description":"Boolean value for configs whose data type is boolean or feature-toggle. Nullable for non-boolean/configs.","nullable":true},{"name":"json_value","type":"string","description":"JSON-encoded string for configs with structured data. Nullable for non-json/configs.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-delete timestamp. Null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["config_key","config_scope"],"unique":true}],"plainIndexes":[{"fieldNames":["config_scope"]}],"ginIndexes":[{"fieldName":"config_key"}]},{"name":"shopping_mall_platform_settings","description":"Global platform-wide settings. Used for static-but-editable metadata (site title, description, support info), branding, and legal policies. Not as dynamic as configsâ€”edited via admin and rarely changed. Acts as reference for platform-wide UI/SEO/meta/branding, not for runtime toggles. Directly editable only by admins. No business or domain dependencies. {@link shopping_mall_platform_settings.id}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"site_title_ko","type":"string","description":"Platform/site title for Korean version.","nullable":false},{"name":"site_title_en","type":"string","description":"Platform/site title for English version.","nullable":false},{"name":"site_description_ko","type":"string","description":"Platform/site description for Korean version, used for SEO and UI.","nullable":true},{"name":"site_description_en","type":"string","description":"Platform/site description for English version, used for SEO and UI.","nullable":true},{"name":"support_email","type":"string","description":"Customer support email address.","nullable":true},{"name":"support_phone","type":"string","description":"Customer support phone number (for display in UI/policy).","nullable":true},{"name":"branding_logo_uri","type":"uri","description":"Public URI to primary branding logo image file.","nullable":true},{"name":"privacy_policy_uri","type":"uri","description":"URI to privacy policy legal document (public).","nullable":true},{"name":"terms_of_service_uri","type":"uri","description":"URI to terms of service legal document (public).","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-delete timestamp. Null if not deleted.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[],"ginIndexes":[{"fieldName":"site_title_ko"},{"fieldName":"site_title_en"}]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"shopping_mall_customers","description":"Primary table for regular customers of the shopping mall. Stores core authentication credentials, profile attributes, account verification status, and soft deletion tracking. Supports independent customer onboarding, profile management, and login/authentication workflows.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","description":"Customer's unique login email address, used for authentication and communications.","nullable":false},{"name":"password_hash","type":"string","description":"BCrypt hash of the customer's authentication password. Never store plain text passwords.","nullable":false},{"name":"full_name","type":"string","description":"Customer's displayable full name for orders and account management.","nullable":false},{"name":"phone","type":"string","description":"Customer's main phone number for account verification and notifications.","nullable":false},{"name":"status","type":"string","description":"Current account status (e.g., active, suspended, pending_verification, etc.).","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the customer has completed email verification.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of customer registration.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of latest customer profile update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp marking soft deletion (if account is deleted or withdrawn).","nullable":true}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["status"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"full_name"}]},{"name":"shopping_mall_sellers","description":"Primary table for sellers. Stores core authentication, profile, business/KYC information, approval state, and operational status. Enables independent onboarding and management for marketplace sellers.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","description":"Unique email for seller login/authentication.","nullable":false},{"name":"password_hash","type":"string","description":"BCrypt hash of seller's password.","nullable":false},{"name":"business_name","type":"string","description":"Formal business entity name of the seller.","nullable":false},{"name":"contact_name","type":"string","description":"Individual's name for seller account contacts and support.","nullable":false},{"name":"phone","type":"string","description":"Seller's primary contact phone number.","nullable":false},{"name":"kyc_document_uri","type":"uri","description":"URI to uploaded KYC document (business registration, ID, etc.).","nullable":true},{"name":"approval_status","type":"string","description":"Account approval/verification status: pending, approved, rejected, suspended, etc.","nullable":false},{"name":"business_registration_number","type":"string","description":"Legal registration number for seller's business entity.","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the seller's email has been verified.","nullable":false},{"name":"created_at","type":"datetime","description":"Date/time seller account was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Date/time of last update to the seller account.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp for soft deletion, if seller is removed from platform.","nullable":true}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true},{"fieldNames":["business_registration_number"],"unique":true}],"plainIndexes":[{"fieldNames":["approval_status"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"business_name"}]},{"name":"shopping_mall_admins","description":"Primary table for platform administrators. Manages credentials, permissions, 2FA secrets, and key profile/audit attributes. Required for secure, auditable admin platform access with multi-factor authentication.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","description":"Admin's unique email address for login and communications.","nullable":false},{"name":"password_hash","type":"string","description":"BCrypt hash of admin's password.","nullable":false},{"name":"full_name","type":"string","description":"Admin's name for audit and dashboard tracking.","nullable":false},{"name":"status","type":"string","description":"Admin account status (active, disabled, suspended, etc.).","nullable":false},{"name":"two_factor_secret","type":"string","description":"Secret key for TOTP-based two-factor auth. Encrypted and stored securely; required for login flows.","nullable":true},{"name":"last_login_at","type":"datetime","description":"Timestamp of administrator's last successful login.","nullable":true},{"name":"created_at","type":"datetime","description":"Admin account creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated timestamp for the admin profile.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp of logical deletion, if account is removed.","nullable":true}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["status"]}],"ginIndexes":[{"fieldName":"full_name"}]},{"name":"shopping_mall_customer_addresses","description":"Stores addresses managed by customers for shipping, billing, and delivery. Linked to individual customers. Not a standalone business entity; supports multiple addresses per customer, with default/primary flag and region info.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_customers.id}","relation":{"name":"customer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"recipient_name","type":"string","description":"Name of the individual receiving the shipment.","nullable":false},{"name":"phone","type":"string","description":"Contact number for delivery at address.","nullable":false},{"name":"region","type":"string","description":"Administrative region (e.g., city, province, district).","nullable":false},{"name":"postal_code","type":"string","description":"Postal or ZIP code for the address.","nullable":false},{"name":"address_line1","type":"string","description":"First line of the address (street/number).","nullable":false},{"name":"address_line2","type":"string","description":"Second line of address, optional (apartment, unit, etc.).","nullable":true},{"name":"is_default","type":"boolean","description":"Whether this is the customer's default address.","nullable":false},{"name":"created_at","type":"datetime","description":"Date/time address entry was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Date/time of last change to the address entry.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp of logical deletion, if address is removed.","nullable":true}],"uniqueIndexes":[{"fieldNames":["customer_id","is_default"],"unique":true}],"plainIndexes":[{"fieldNames":["customer_id"]},{"fieldNames":["region"]}],"ginIndexes":[{"fieldName":"address_line1"}]},{"name":"shopping_mall_seller_addresses","description":"Sellers' addresses for business, returns, or shipping. Managed per seller, supports multiple addresses with type (e.g., business, shipping, return) and region. Not independently managed by users.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"seller_id","type":"uuid","description":"Belonged seller's {@link shopping_mall_sellers.id}","relation":{"name":"seller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":false}],"plainFields":[{"name":"type","type":"string","description":"Address type: business, shipping, or return.","nullable":false},{"name":"recipient_name","type":"string","description":"Recipient or company name for this address.","nullable":false},{"name":"phone","type":"string","description":"Contact number for this address.","nullable":false},{"name":"region","type":"string","description":"Geographic/administrative area (city, province, etc.).","nullable":false},{"name":"postal_code","type":"string","description":"ZIP/postal code of the address.","nullable":false},{"name":"address_line1","type":"string","description":"Primary address line (street/number).","nullable":false},{"name":"address_line2","type":"string","description":"Secondary address line (apartment/suite etc.), optional.","nullable":true},{"name":"is_primary","type":"boolean","description":"Whether this address is the primary business address for seller.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp of soft deletion/removal.","nullable":true}],"uniqueIndexes":[{"fieldNames":["seller_id","type"],"unique":true}],"plainIndexes":[{"fieldNames":["seller_id"]}],"ginIndexes":[{"fieldName":"address_line1"}]},{"name":"shopping_mall_roles","description":"System-wide role definitions. Stores all role types supported on the platform (customer, seller, admin, plus future extensible values), isolated for controlled assignment to user entities.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"role_name","type":"string","description":"Role key in uppercase (e.g. CUSTOMER, SELLER, ADMIN, ...).","nullable":false},{"name":"description","type":"string","description":"Explanation of platform permissions for the role.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of role creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last modification.","nullable":false}],"uniqueIndexes":[{"fieldNames":["role_name"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"description"}]},{"name":"shopping_mall_user_sessions","description":"Active and historical user sessions for authentication. Tracks current session, refresh token, and optional device metadata for each logged user or admin. Used for revoking sessions/security audit.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"user_id","type":"uuid","description":"ID of associated customer, seller, or admin. Can reference any actor. Application-level logic controls correct FK.","relation":{"name":"user","targetModel":"shopping_mall_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"access_token","type":"string","description":"Opaque JWT access token for this session.","nullable":false},{"name":"refresh_token","type":"string","description":"Refresh token string issued for session prolongation.","nullable":false},{"name":"expires_at","type":"datetime","description":"Session expiry timestamp.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Time of manual or automatic session revocation, if any.","nullable":true},{"name":"device_info","type":"string","description":"Client device, browser, or IP information (for auditing/oauth, optional).","nullable":true},{"name":"created_at","type":"datetime","description":"Session creation timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["access_token"],"unique":true},{"fieldNames":["refresh_token"],"unique":true}],"plainIndexes":[{"fieldNames":["user_id"]}],"ginIndexes":[]},{"name":"shopping_mall_email_verifications","description":"Active or historical email verification records. Used for initial signup, change of email, and re-verification flows. Contains token and expiry per user; managed at the authentication layer.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"user_id","type":"uuid","description":"FK to verified user (may reference customer, seller, or admin table logic).","relation":{"name":"user","targetModel":"shopping_mall_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"email","type":"string","description":"Email address subject to verification process.","nullable":false},{"name":"token","type":"string","description":"Opaque/secure verification token for email activation.","nullable":false},{"name":"expires_at","type":"datetime","description":"Date/time when verification expires.","nullable":false},{"name":"verified_at","type":"datetime","description":"Timestamp when verification was successfully completed.","nullable":true},{"name":"created_at","type":"datetime","description":"Verification record creation time.","nullable":false}],"uniqueIndexes":[{"fieldNames":["token"],"unique":true}],"plainIndexes":[{"fieldNames":["email"]}],"ginIndexes":[]},{"name":"shopping_mall_password_resets","description":"Password reset tokens generated upon user request. Supports secure token-based password recovery, with expiry tracking and single-use enforcement. Not directly user-managed.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"user_id","type":"uuid","description":"FK to account requesting password reset (customer/seller/admin by app logic).","relation":{"name":"user","targetModel":"shopping_mall_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"token","type":"string","description":"Secure, random password reset token.","nullable":false},{"name":"expires_at","type":"datetime","description":"Date/time when password reset token expires.","nullable":false},{"name":"used_at","type":"datetime","description":"Timestamp the token was used for password reset.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation date/time.","nullable":false}],"uniqueIndexes":[{"fieldNames":["token"],"unique":true}],"plainIndexes":[{"fieldNames":["user_id"]}],"ginIndexes":[]}]},{"filename":"schema-03-catalog.prisma","namespace":"Catalog","models":[{"name":"shopping_mall_products","description":"Represents an individual product for sale in the shopping mall. A product belongs to a seller and is assigned to a leaf category. Each product can have multiple SKUs/variants, options, option values, and images. Product status (active, disabled) is managed here. {@link shopping_mall_product_skus}, {@link shopping_mall_product_categories}, {@link shopping_mall_catalog_images} support this entity.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_seller_id","type":"uuid","description":"Reference to product's seller. {@link shopping_mall_sellers.id}","relation":{"name":"seller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":false},{"name":"shopping_mall_category_id","type":"uuid","description":"Reference to category this product is assigned to (must be leaf). {@link shopping_mall_categories.id}","relation":{"name":"category","targetModel":"shopping_mall_categories"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","description":"Product display name.","nullable":false},{"name":"description","type":"string","description":"Long description of the product.","nullable":false},{"name":"is_active","type":"boolean","description":"Whether the product is currently active and listed.","nullable":false},{"name":"main_image_url","type":"uri","description":"Primary display image for this product.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp for soft deletion; null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_seller_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_category_id"]},{"fieldNames":["is_active"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_product_skus","description":"Represents a sellable product variant (SKU) with a unique combination of option values, price, status, and inventory. SKUs are linked to products and maintain their own images and inventory records. Options and values are connected via {@link shopping_mall_product_sku_option_values}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_id","type":"uuid","description":"Reference to parent product. {@link shopping_mall_products.id}","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"sku_code","type":"string","description":"Business-unique identifier for this SKU (e.g. GTIN, or logical code).","nullable":false},{"name":"name","type":"string","description":"Display name for this SKU (e.g., 'Red L').","nullable":false},{"name":"price","type":"double","description":"Sell price for this SKU.","nullable":false},{"name":"status","type":"string","description":"SKU status such as 'active', 'inactive', 'blocked', etc.","nullable":false},{"name":"low_stock_threshold","type":"int","description":"Custom low-stock warning threshold for this SKU.","nullable":true},{"name":"main_image_url","type":"uri","description":"Primary SKU image URL, used in option selection.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for SKU record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for SKU record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp for SKU, if applicable.","nullable":true}],"uniqueIndexes":[{"fieldNames":["sku_code"],"unique":true},{"fieldNames":["shopping_mall_product_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_product_id"]},{"fieldNames":["status"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_product_options","description":"Defines an option/attribute for a product (e.g., color, size). Each option belongs to a product and can have multiple values. Used to generate variant combinations. {@link shopping_mall_product_option_values} reference this.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_id","type":"uuid","description":"Parent product for this option. {@link shopping_mall_products.id}","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","description":"Option display name (e.g. 'Color').","nullable":false},{"name":"display_order","type":"int","description":"Ordering of options for presentation.","nullable":false},{"name":"created_at","type":"datetime","description":"Created time for option.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated time for option.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_product_id"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_product_option_values","description":"Lists available values for a given product option. (e.g., 'Red', 'XL' for Color and Size). Tied to one parent option. Used in SKU-option mapping.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_option_id","type":"uuid","description":"Parent option for this value. {@link shopping_mall_product_options.id}","relation":{"name":"option","targetModel":"shopping_mall_product_options"},"unique":false,"nullable":false}],"plainFields":[{"name":"value","type":"string","description":"Display value for this option (e.g., 'Red').","nullable":false},{"name":"display_order","type":"int","description":"Ordering among sibling values for UI.","nullable":false},{"name":"created_at","type":"datetime","description":"Created time for value.","nullable":false},{"name":"updated_at","type":"datetime","description":"Updated time for value.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_option_id","value"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_product_option_id"]}],"ginIndexes":[{"fieldName":"value"}]},{"name":"shopping_mall_product_sku_option_values","description":"Junction table mapping a SKU to its chosen option values (e.g., SKU1 = Red, Size L). Supports M:N between SKUs and option values. Each row uniquely defines a SKU's configuration for one option.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_sku_id","type":"uuid","description":"The owning SKU. {@link shopping_mall_product_skus.id}","relation":{"name":"sku","targetModel":"shopping_mall_product_skus"},"unique":false,"nullable":false},{"name":"shopping_mall_product_option_value_id","type":"uuid","description":"The selected option value linked to this SKU. {@link shopping_mall_product_option_values.id}","relation":{"name":"optionValue","targetModel":"shopping_mall_product_option_values"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Mapping creation timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_sku_id","shopping_mall_product_option_value_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_product_sku_id"]},{"fieldNames":["shopping_mall_product_option_value_id"]}],"ginIndexes":[]},{"name":"shopping_mall_catalog_images","description":"Images for products or product SKUs. Each image links either to a product or SKU. Used for catalog/gallery display. Images are uploaded and managed only through parent product/SKU.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_id","type":"uuid","description":"Product this image belongs to. {@link shopping_mall_products.id}","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":false,"nullable":true},{"name":"shopping_mall_product_sku_id","type":"uuid","description":"SKU this image belongs to, if applicable. {@link shopping_mall_product_skus.id}","relation":{"name":"sku","targetModel":"shopping_mall_product_skus"},"unique":false,"nullable":true}],"plainFields":[{"name":"url","type":"uri","description":"Image CDN URL.","nullable":false},{"name":"alt_text","type":"string","description":"Alternative text for the image, for accessibility.","nullable":true},{"name":"display_order","type":"int","description":"Order for gallery sorting.","nullable":false},{"name":"created_at","type":"datetime","description":"Upload timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["url"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_product_id"]},{"fieldNames":["shopping_mall_product_sku_id"]}],"ginIndexes":[{"fieldName":"alt_text"}]},{"name":"shopping_mall_product_categories","description":"Links a product to a category. Used to normalize product-category assignment and support many-to-one or future expansion (e.g. multi-category products). Each link references a single product and a single category (leaf). Admin control propagates via category.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_id","type":"uuid","description":"Linked product. {@link shopping_mall_products.id}","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":false,"nullable":false},{"name":"shopping_mall_category_id","type":"uuid","description":"Linked category (must be a leaf category). {@link shopping_mall_categories.id}","relation":{"name":"category","targetModel":"shopping_mall_categories"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Time of assignment.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_id","shopping_mall_category_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_category_id"]}],"ginIndexes":[]},{"name":"shopping_mall_inventory_records","description":"Tracks SKU-level inventory state, including quantities available, reserved, and sold. Supports custom low-stock threshold per SKU. Each inventory record belongs to a SKU, and is updated as stock moves between states (available, reserved, sold, blocked, out_of_stock). Linked to the SKU and product. Used for stock display and order validation.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_sku_id","type":"uuid","description":"SKU whose inventory is being tracked. {@link shopping_mall_product_skus.id}","relation":{"name":"sku","targetModel":"shopping_mall_product_skus"},"unique":true,"nullable":false}],"plainFields":[{"name":"quantity_available","type":"int","description":"Inventory available for sale.","nullable":false},{"name":"quantity_reserved","type":"int","description":"Quantity reserved (e.g. pending orders).","nullable":false},{"name":"quantity_sold","type":"int","description":"Cumulative quantity sold for reporting.","nullable":false},{"name":"low_stock_threshold","type":"int","description":"Low stock notification threshold.","nullable":true},{"name":"status","type":"string","description":"Inventory status such as 'in_stock', 'reserved', 'blocked', 'out_of_stock'.","nullable":false},{"name":"created_at","type":"datetime","description":"Inventory record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for record.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_sku_id"],"unique":true}],"plainIndexes":[{"fieldNames":["status"]},{"fieldNames":["quantity_available"]}],"ginIndexes":[]},{"name":"shopping_mall_inventory_logs","description":"Audit trail of inventory adjustments per SKU. Records manual/admin/seller increases or decreases, related order, actor id (seller or admin), adjustment quantity/reason, and timestamp. Critical for preventing out-of-sync state and supporting rollback/debugging.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_inventory_record_id","type":"uuid","description":"The inventory record this log pertains to. {@link shopping_mall_inventory_records.id}","relation":{"name":"inventoryRecord","targetModel":"shopping_mall_inventory_records"},"unique":false,"nullable":false},{"name":"shopping_mall_seller_id","type":"uuid","description":"The seller who performed the inventory change (if applicable). {@link shopping_mall_sellers.id}","relation":{"name":"seller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"shopping_mall_admin_id","type":"uuid","description":"The admin who performed the inventory change (if applicable). {@link shopping_mall_admins.id}","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"change_type","type":"string","description":"Type of inventory change (increase, decrease, block, unblock, correction, etc.).","nullable":false},{"name":"quantity_changed","type":"int","description":"Quantity changed in this log entry (+/-).","nullable":false},{"name":"reason","type":"string","description":"Reason for the adjustment (manual, purchase, refund, system correction, etc.).","nullable":true},{"name":"reference_id","type":"uuid","description":"Optional reference to related order/event (e.g. order id).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when log was recorded.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_inventory_record_id"]},{"fieldNames":["shopping_mall_seller_id"]},{"fieldNames":["shopping_mall_admin_id"]}],"ginIndexes":[]}]},{"filename":"schema-04-shopping.prisma","namespace":"Shopping","models":[{"name":"shopping_mall_carts","description":"Represents a customer's shopping cart before order placement. Each customer can have only one active cart at a time, holding zero or more cart items. The cart persists for abandoned sessions and is restored on user login. Related to {@link shopping_mall_customers}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_customers.id}. Represents cart ownership by a customer. Must be unique per customer.","relation":{"name":"customer","targetModel":"shopping_mall_customers"},"unique":true,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Timestamp when this cart was created (initial assignment or first use).","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of the last modification of this cart or its items.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_customer_id"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_cart_items","description":"Line items within a shopping cart, each referencing a product SKU, and storing quantity and unit price at the time of cart insertion. Always managed through its parent cart. Related to {@link shopping_mall_carts}, {@link shopping_mall_product_skus}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_cart_id","type":"uuid","description":"Cart containing this item. References {@link shopping_mall_carts.id}.","relation":{"name":"cart","targetModel":"shopping_mall_carts"},"unique":false,"nullable":false},{"name":"shopping_mall_product_sku_id","type":"uuid","description":"Referenced product SKU. Foreign key to {@link shopping_mall_product_skus.id}.","relation":{"name":"productSku","targetModel":"shopping_mall_product_skus"},"unique":false,"nullable":false}],"plainFields":[{"name":"quantity","type":"int","description":"Number of units of this SKU in the cart (must be at least 1, up to business-configured maximum).","nullable":false},{"name":"unit_price_snapshot","type":"double","description":"Unit price of the SKU at the time the item was added to cart. Used for price consistency and historical context. Not adjusted after addition.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when this cart item was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when this cart item was last modified (quantity updated, etc.).","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_cart_id","shopping_mall_product_sku_id"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["shopping_mall_cart_id"]}],"ginIndexes":[]},{"name":"shopping_mall_wishlists","description":"Saved wishlist for a customer. Each customer may have one wishlist, containing wishlist items (not specific SKUs). Managed independently of cart. Related to {@link shopping_mall_customers}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_customer_id","type":"uuid","description":"Wishlist owner. References {@link shopping_mall_customers.id}. Must be unique per customer.","relation":{"name":"customer","targetModel":"shopping_mall_customers"},"unique":true,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Timestamp when wishlist was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last modification or addition/removal of items.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_customer_id"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_wishlist_items","description":"Line items within a customer's wishlist, linking wishlist to products (not SKUs). Managed as subsidiary of wishlist entity. Enforces uniqueness per (wishlist, product) pair. Related to {@link shopping_mall_wishlists} and {@link shopping_mall_products}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_wishlist_id","type":"uuid","description":"Wishlist this item belongs to. References {@link shopping_mall_wishlists.id}.","relation":{"name":"wishlist","targetModel":"shopping_mall_wishlists"},"unique":false,"nullable":false},{"name":"shopping_mall_product_id","type":"uuid","description":"Product reference for wishlist item. References {@link shopping_mall_products.id}.","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Timestamp when this product was added to the wishlist.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to this wishlist item.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_wishlist_id","shopping_mall_product_id"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["shopping_mall_wishlist_id"]}],"ginIndexes":[]}]},{"filename":"schema-05-orders.prisma","namespace":"Orders","models":[{"name":"shopping_mall_orders","description":"Main order header table representing the root transaction for customer purchases. Each order records customer, (optional) seller, overall status, pricing summary, key dates, and links to full audit and lifecycle trail. Core business entity for CRUD operations. References related entities: shopping_mall_customers, shopping_mall_sellers, shopping_mall_order_addresses, shopping_mall_order_payment_methods. Audit fields support recovery and traceability across lifecycles.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":false},{"name":"shopping_mall_seller_id","type":"uuid","description":"Optional seller ref for marketplace cases; null for multi-seller split orders. References {@link shopping_mall_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"shipping_address_id","type":"uuid","description":"Snapshot of shipping address at time of order creation. References {@link shopping_mall_order_addresses.id}.","relation":{"name":"shippingAddress","targetModel":"shopping_mall_order_addresses"},"unique":false,"nullable":false},{"name":"payment_method_id","type":"uuid","description":"Snapshot of payment method at time of order. References {@link shopping_mall_order_payment_methods.id}.","relation":{"name":"paymentMethod","targetModel":"shopping_mall_order_payment_methods"},"unique":false,"nullable":false}],"plainFields":[{"name":"order_number","type":"string","description":"Globally unique business order number (external/public facing).","nullable":false},{"name":"status","type":"string","description":"Current order status (e.g., pending, paid, processing, shipped, delivered, cancelled).","nullable":false},{"name":"business_status","type":"string","description":"Order workflow or business state (e.g., hold, review, escalated).","nullable":true},{"name":"order_total","type":"double","description":"Total price for entire order (including item total, shipping fee, discount applied, etc.).","nullable":false},{"name":"currency","type":"string","description":"Currency code (e.g., USD, KRW).","nullable":false},{"name":"placed_at","type":"datetime","description":"Timestamp when order was placed by customer.","nullable":false},{"name":"paid_at","type":"datetime","description":"Timestamp when payment was completed (if completed).","nullable":true},{"name":"fulfilled_at","type":"datetime","description":"Timestamp when order fully fulfilled (shipped/delivered, if applicable).","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last modification timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-deletion timestamp if record is logically deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["order_number"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_customer_id"]},{"fieldNames":["shopping_mall_seller_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_order_items","description":"Items table detailing specific SKUs and quantities included in an order. One-to-many from shopping_mall_orders. Each row references a purchased SKU, pricing, quantity, item-level refund/cancellation state. Always managed through parent order. References shopping_mall_order, shopping_mall_product_skus.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"shopping_mall_product_sku_id","type":"uuid","description":"Purchased SKU's {@link shopping_mall_product_skus.id}.","relation":{"name":"productSku","targetModel":"shopping_mall_product_skus"},"unique":false,"nullable":false}],"plainFields":[{"name":"item_name","type":"string","description":"Display name of the product/SKU at time of purchase (for history, snapshot).","nullable":false},{"name":"sku_code","type":"string","description":"SKU business code/string.","nullable":false},{"name":"quantity","type":"int","description":"Units purchased for this SKU.","nullable":false},{"name":"unit_price","type":"double","description":"Unit price at time of purchase.","nullable":false},{"name":"currency","type":"string","description":"Currency code for the item pricing.","nullable":false},{"name":"item_total","type":"double","description":"Item-level total (quantity * unit price less discounts, if any).","nullable":false},{"name":"refund_status","type":"string","description":"Item-level refund/cancellation state. E.g., none, pending, refunded, cancelled.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last modification timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-deletion timestamp if record is logically deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_order_id","shopping_mall_product_sku_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_order_id"]}],"ginIndexes":[]},{"name":"shopping_mall_order_shipments","description":"Tracks individual shipments for an order (may be multiple if split fulfillment). References order and contains carrier, tracking, status, and key shipment events. Supports sub-order (split shipment) for multi-seller cases. Always subsidiary to parent order.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false}],"plainFields":[{"name":"shipment_number","type":"string","description":"Business code for shipment/sub-shipment. Uniquely identifies shipment within order.","nullable":false},{"name":"carrier","type":"string","description":"Carrier name (logistics partner, e.g., CJ, FedEx, Sagawa).","nullable":false},{"name":"tracking_number","type":"string","description":"Carrier-provided tracking number.","nullable":true},{"name":"status","type":"string","description":"Current shipment status (e.g., pending, shipped, in_transit, out_for_delivery, delivered, returned, cancelled).","nullable":false},{"name":"dispatched_at","type":"datetime","description":"Timestamp when shipment was dispatched/handed to carrier.","nullable":true},{"name":"delivered_at","type":"datetime","description":"Timestamp when shipment was delivered.","nullable":true},{"name":"remark","type":"string","description":"Seller/admin comments, special instructions or internal notes.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last modification timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-deletion timestamp if record is logically deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_order_id","shipment_number"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_order_id"]},{"fieldNames":["carrier"]}],"ginIndexes":[]},{"name":"shopping_mall_order_status_history","description":"Transactional timeline of order status/state changes over lifecycle (e.g., placed, paid, shipped, delivered, cancelled, returned). Supports audit, review, and order history trace. Each event links to parent order and optionally actor (customer, seller, admin).","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"actor_customer_id","type":"uuid","description":"Event initiator's customer id (if actioned by customer, optional). References {@link shopping_mall_customers.id}.","relation":{"name":"actorCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"actor_seller_id","type":"uuid","description":"Event initiator's seller id (if actioned by seller, optional). References {@link shopping_mall_sellers.id}.","relation":{"name":"actorSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"actor_admin_id","type":"uuid","description":"Event initiator's admin id (if actioned by admin, optional). References {@link shopping_mall_admins.id}.","relation":{"name":"actorAdmin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"event_type","type":"string","description":"Type of order event (placed, status_change, cancel_requested, refund_requested, shipment_updated, etc).","nullable":false},{"name":"status_before","type":"string","description":"Order status before transition (for audit/history).","nullable":true},{"name":"status_after","type":"string","description":"Order status after transition (for audit/history).","nullable":true},{"name":"message","type":"string","description":"Event comment, explanation, or internal note for audit.","nullable":true},{"name":"created_at","type":"datetime","description":"Timeline event creation timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_order_id"]},{"fieldNames":["event_type"]}],"ginIndexes":[]},{"name":"shopping_mall_order_payments","description":"Payment records tied to an order: captures attempted/actual payments, retries, refunds, payment gateway responses, and reconciliation. Possible for multi/partial payments per order. References parent order and payment method snapshot. Subsidiary entity managed via order actions.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"order_payment_method_id","type":"uuid","description":"Payment method used (payment method snapshot). References {@link shopping_mall_order_payment_methods.id}.","relation":{"name":"paymentMethod","targetModel":"shopping_mall_order_payment_methods"},"unique":false,"nullable":false}],"plainFields":[{"name":"payment_ref","type":"string","description":"External payment processor/gateway reference/transaction id.","nullable":false},{"name":"payment_type","type":"string","description":"Payment method type (e.g., card, bank_transfer, paypal, toss).","nullable":false},{"name":"status","type":"string","description":"Payment current status (authorized, captured, failed, refunded, pending).","nullable":false},{"name":"paid_amount","type":"double","description":"Amount that was paid (for this payment event).","nullable":false},{"name":"currency","type":"string","description":"Currency code.","nullable":false},{"name":"paid_at","type":"datetime","description":"Timestamp of payment success (if success).","nullable":true},{"name":"reconciliation_at","type":"datetime","description":"When payment record reconciled with external/bank/accounting records.","nullable":true},{"name":"fail_reason","type":"string","description":"Failure cause/detail if payment was not successful (from gateway or business rule).","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp for logical deletion.","nullable":true}],"uniqueIndexes":[{"fieldNames":["payment_ref"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_order_id"]},{"fieldNames":["order_payment_method_id"]}],"ginIndexes":[]},{"name":"shopping_mall_order_cancellations","description":"Cancellation requests/events for orders. Includes state, reason, status (pending/approved/denied), actors, timestamps, and audit. Each references parent order and, optionally, linked payment/refund/reason. Critical for compliance and business event auditing. Subsidiary entity.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"initiator_customer_id","type":"uuid","description":"Customer who requested the cancellation (nullable if not a customer-initiated event). References {@link shopping_mall_customers.id}.","relation":{"name":"initiatorCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"initiator_seller_id","type":"uuid","description":"Seller who initiated or handled cancellation, if relevant. References {@link shopping_mall_sellers.id}.","relation":{"name":"initiatorSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"initiator_admin_id","type":"uuid","description":"Admin who handled or initiated the cancellation. References {@link shopping_mall_admins.id}.","relation":{"name":"initiatorAdmin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"reason_code","type":"string","description":"Business reason code for cancellation (customer_request, fraud_suspected, oos, seller_failure, etc.).","nullable":false},{"name":"status","type":"string","description":"Current cancellation request status (pending, approved, denied, completed, etc.).","nullable":false},{"name":"explanation","type":"string","description":"Explanation or justification text for this cancellation event (optional, for audit/appeal).","nullable":true},{"name":"requested_at","type":"datetime","description":"Timestamp when cancellation was requested.","nullable":false},{"name":"resolved_at","type":"datetime","description":"Timestamp when cancellation resolved/closed.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last modification timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_order_id"]},{"fieldNames":["status"]}],"ginIndexes":[]},{"name":"shopping_mall_order_refunds","description":"Refund events for orders or specific items. Each entry records refund request, approval/denial, status, payout, linkage to payments if relevant. Required for financial, compliance, and customer-service audit. Subsidiary under parent order but may reference payments/items for detail.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"refunded_payment_id","type":"uuid","description":"Order payment this refund event is against/reference. References {@link shopping_mall_order_payments.id}.","relation":{"name":"refundedPayment","targetModel":"shopping_mall_order_payments"},"unique":false,"nullable":true},{"name":"initiator_customer_id","type":"uuid","description":"Customer who requested the refund (nullable if admin-driven).","relation":{"name":"initiatorCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"initiator_admin_id","type":"uuid","description":"Admin who approved/denied/handled this refund event, if any.","relation":{"name":"initiatorAdmin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"reason_code","type":"string","description":"Business reason code for refund (customer_cancel, failed_delivery, defective, overcharge, goodwill, etc).","nullable":false},{"name":"status","type":"string","description":"Current refund event status (pending, approved, denied, completed, failed, etc).","nullable":false},{"name":"refund_amount","type":"double","description":"Amount refunded by this event (partial/full allowed).","nullable":false},{"name":"currency","type":"string","description":"Currency code.","nullable":false},{"name":"requested_at","type":"datetime","description":"When refund was requested.","nullable":false},{"name":"settled_at","type":"datetime","description":"When refund was settled or completed (payout occurred).","nullable":true},{"name":"explanation","type":"string","description":"Free-text explanation for audit and escalations.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_order_id"]},{"fieldNames":["refunded_payment_id"]}],"ginIndexes":[]},{"name":"shopping_mall_order_addresses","description":"Order-level snapshot of address used for shipping and/or billing at order time. Ensures point-in-time accuracy regardless of later address edits or deletions by customer. Used for legal/audit/compliance and accurate historical recordkeeping. Subsidiary to order, referenced by order header and possibly by shipments.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"address_type","type":"string","description":"Type: shipping or billing or both (string code).","nullable":false},{"name":"recipient_name","type":"string","description":"Recipient's full name at time of order.","nullable":false},{"name":"phone","type":"string","description":"Recipient's phone number/contact at time of order.","nullable":false},{"name":"zip_code","type":"string","description":"Postal code.","nullable":false},{"name":"address_main","type":"string","description":"Main address (street, city, etc).","nullable":false},{"name":"address_detail","type":"string","description":"Detailed address/apt/suite/floor, etc.","nullable":true},{"name":"country_code","type":"string","description":"ISO country code at time of order.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["country_code"]}],"ginIndexes":[]},{"name":"shopping_mall_order_payment_methods","description":"Snapshot of specific payment method used at order time (for audit and accurate replay). Stores payment method info as of order placement. References from orders and order_payments to ensure point-in-time method data. Subsidiary only, never accessed independently.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"payment_method_type","type":"string","description":"Type of method (e.g., card, bank_transfer, paypal, virtual_account).","nullable":false},{"name":"method_data","type":"string","description":"JSON or encoded data for this payment method at time of order (e.g., masked card, bank name, etc).","nullable":false},{"name":"display_name","type":"string","description":"Masked or obfuscated display for UI (e.g., Visa ****1234).","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[],"ginIndexes":[]}]},{"filename":"schema-06-reviews.prisma","namespace":"Reviews","models":[{"name":"shopping_mall_reviews","description":"Main entity for product reviews. Each review is authored by a customer after purchasing a product, linked to both the product and order for verification (only 1 review per (customer, product, order)). Contains star rating (1-5), review body, status for moderation (pending, approved, rejected, hidden), and supports soft deletion. Related entities include review images, review replies (seller/admin), and flags for abuses. Moderation audit is handled via status and timestamps. Used for aggregation in {@link shopping_mall_product_rating_aggregates}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_id","type":"uuid","description":"Belonged product's {@link shopping_mall_products.id}. Required for aggregation and display.","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":false,"nullable":false},{"name":"shopping_mall_order_id","type":"uuid","description":"Order verifying purchase {@link shopping_mall_orders.id}. Needed to enforce 1 review per (customer, product, order).","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"shopping_mall_customer_id","type":"uuid","description":"Review author's {@link shopping_mall_customers.id}. For verification, reward, and audit.","relation":{"name":"customer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"rating","type":"int","description":"Star rating, integer 1-5.","nullable":false},{"name":"body","type":"string","description":"Main review body provided by the author. Text, 10-2000 characters.","nullable":false},{"name":"status","type":"string","description":"Review moderation status: 'pending', 'approved', 'rejected', or 'hidden'. Decides visibility and eligibility for aggregation/reward.","nullable":false},{"name":"comment","type":"string","description":"Optional public moderation/admin/seller comment on the review. Used for rejected/hidden explanations. Optional.","nullable":true},{"name":"created_at","type":"datetime","description":"Review creation timestamp (for audit and timeline sorting).","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp. Audit and concurrency control.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete flag for review retraction or admin takedown. Allows recovery for audits.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_id","shopping_mall_customer_id","shopping_mall_order_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_product_id","status"]},{"fieldNames":["shopping_mall_customer_id","status"]}],"ginIndexes":[{"fieldName":"body"},{"fieldName":"comment"}]},{"name":"shopping_mall_review_images","description":"Images attached to a product review. Allows multiple (up to 5) image files per review, each referencing uri. Managed as a subsidiary entity, only via review CRUD. Used for moderation of review content. Links only to reviews.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_review_id","type":"uuid","description":"Parent review's {@link shopping_mall_reviews.id}.","relation":{"name":"review","targetModel":"shopping_mall_reviews"},"unique":false,"nullable":false}],"plainFields":[{"name":"image_uri","type":"uri","description":"URI for the attached image file. Required.","nullable":false},{"name":"created_at","type":"datetime","description":"Image attachment creation time (for audit).","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_review_id"]}],"ginIndexes":[]},{"name":"shopping_mall_review_flags","description":"Flags for abuse/reported content on reviews. Created by users, sellers, or admins to signal moderation. Each flag links to one review and, optionally, to the actor (user, seller, admin). Includes status (open, resolved, rejected), reason, internal note/comment, and audit timestamps for moderation flow. Managed by admins for policy and moderation process tracking.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_review_id","type":"uuid","description":"Targeted review's {@link shopping_mall_reviews.id}.","relation":{"name":"review","targetModel":"shopping_mall_reviews"},"unique":false,"nullable":false},{"name":"shopping_mall_customer_id","type":"uuid","description":"Flag submitted by this customer (optional if submitted by seller/admin).","relation":{"name":"customer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"shopping_mall_seller_id","type":"uuid","description":"Flag submitted by seller (optional).","relation":{"name":"seller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"shopping_mall_admin_id","type":"uuid","description":"Flag submitted by admin (optional, e.g. moderation or policy violation).","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"reason","type":"string","description":"Reason code or short description why review is flagged for moderation (e.g., 'abuse', 'spam', 'policy_violation').","nullable":false},{"name":"note","type":"string","description":"Optional internal note for admin handling, moderation, or escalation.","nullable":true},{"name":"status","type":"string","description":"Flag workflow state: 'open', 'resolved', or 'rejected'. Determines whether moderation is still pending or closed.","nullable":false},{"name":"created_at","type":"datetime","description":"Flag creation timestamp (for audit and timeline).","nullable":false},{"name":"updated_at","type":"datetime","description":"Last status/note update timestamp. Required for process audit.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_review_id","status"]}],"ginIndexes":[{"fieldName":"reason"},{"fieldName":"note"}]},{"name":"shopping_mall_review_replies","description":"Seller or admin's public reply to a product review. Linked to one review and the actor (seller or admin). Only one reply per review per responder (enforced by unique index). Includes reply body, visibility status, soft delete (deleted_at) and audit timestamps. Managed through moderation flows and displayed with the review to the customer.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_review_id","type":"uuid","description":"Parent review's {@link shopping_mall_reviews.id}.","relation":{"name":"review","targetModel":"shopping_mall_reviews"},"unique":false,"nullable":false},{"name":"shopping_mall_seller_id","type":"uuid","description":"Reply author, seller (optional if admin replies).","relation":{"name":"seller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"shopping_mall_admin_id","type":"uuid","description":"Reply author, admin (optional if seller replies).","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"body","type":"string","description":"Reply text. Displayed publicly with the review for transparency.","nullable":false},{"name":"status","type":"string","description":"Reply visibility status: 'public', 'hidden'. Decides if reply is visible to all or only in moderation workflows.","nullable":false},{"name":"created_at","type":"datetime","description":"Reply creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last reply update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete for retracted/taken down replies. Allows audit, hidden from user but recoverable.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_review_id","shopping_mall_seller_id"],"unique":true},{"fieldNames":["shopping_mall_review_id","shopping_mall_admin_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_review_id"]}],"ginIndexes":[{"fieldName":"body"}]},{"name":"shopping_mall_product_rating_aggregates","description":"Materialized view for fast product rating display and search. Stores denormalized product-level aggregates (count, sum, average rating, updated timestamp). Refreshed after review changes for high-performance product listing/sorting. One per product. Not user-editable. Only denormalized data present; business logic recalculates this table after every review change. Hidden from most documentation and APIs.","material":true,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_product_id","type":"uuid","description":"Target product's {@link shopping_mall_products.id}. Unique (one rating aggregate per product).","relation":{"name":"product","targetModel":"shopping_mall_products"},"unique":true,"nullable":false}],"plainFields":[{"name":"review_count","type":"int","description":"Total number of published reviews for this product. Updates on approval or deletion.","nullable":false},{"name":"star_sum","type":"int","description":"Sum of all published review star ratings for average calculation.","nullable":false},{"name":"star_avg","type":"double","description":"Cached average rating (star_sum / review_count). Recalculated by review triggers. Used for sorting/listing optimizations.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when aggregate was last recalculated (for cache invalidation and audit).","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_product_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[]}]},{"filename":"schema-07-customer_service.prisma","namespace":"CustomerService","models":[{"name":"shopping_mall_order_histories","description":"Historical, immutable snapshot of order data at key customer service milestones for audit, compliance, and reporting. Stores key attributes from the original order at the time of notable customer service events (e.g., cancellation, refund, dispute) to support investigation, reconstruct timelines, and enforce retention policies. Related to {@link shopping_mall_orders}.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Belonged order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false}],"plainFields":[{"name":"snapshot_type","type":"string","description":"Type of the customer service event prompting the snapshot (e.g., 'cancellation', 'refund', 'escalation', 'appeal').","nullable":false},{"name":"order_status","type":"string","description":"Order status at the time of the snapshot (copied for audit context).","nullable":false},{"name":"order_total","type":"double","description":"Order amount at the time of event (may include applied refunds/cancellation).","nullable":false},{"name":"snapshot_reason","type":"string","description":"Business reason or comment associated with this history entry (e.g., system-generated, admin note, case user update).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp of the snapshot creation for auditing.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete. Indicates record logically removed for data retention, but not physically deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_order_id","snapshot_type","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["snapshot_type"]},{"fieldNames":["shopping_mall_order_id","created_at"]}],"ginIndexes":[{"fieldName":"snapshot_reason"}]},{"name":"shopping_mall_customer_service_events","description":"Timeline log of customer service activities related to orders, escalations, or appeals. Records discrete events (e.g., case created, investigation, communication, admin action) in sequence for audit, reporting, and rebuilding the complete service journey. Related to one of shopping_mall_order_histories, shopping_mall_escalations, or shopping_mall_appeals depending on event context.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"order_history_id","type":"uuid","description":"Related order history's {@link shopping_mall_order_histories.id}, if event is directly tied to order audit.","relation":{"name":"orderHistory","targetModel":"shopping_mall_order_histories"},"unique":false,"nullable":true},{"name":"shopping_mall_escalation_id","type":"uuid","description":"Related escalation's {@link shopping_mall_escalations.id}, if event is part of an escalation process.","relation":{"name":"escalation","targetModel":"shopping_mall_escalations"},"unique":false,"nullable":true},{"name":"shopping_mall_appeal_id","type":"uuid","description":"Related appeal's {@link shopping_mall_appeals.id}, if event is part of an appeal process.","relation":{"name":"appeal","targetModel":"shopping_mall_appeals"},"unique":false,"nullable":true},{"name":"actor_customer_id","type":"uuid","description":"Actor customer's {@link shopping_mall_customers.id}, if the event was performed by a customer.","relation":{"name":"actorCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"actor_seller_id","type":"uuid","description":"Actor seller's {@link shopping_mall_sellers.id}, if the event was performed by a seller.","relation":{"name":"actorSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"actor_admin_id","type":"uuid","description":"Actor admin's {@link shopping_mall_admins.id}, if the event was performed by an admin.","relation":{"name":"actorAdmin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"event_type","type":"string","description":"Type/category of the service event (e.g., 'case-open', 'message', 'investigation', 'resolution', 'appeal-filed', etc).","nullable":false},{"name":"event_status","type":"string","description":"Status of this event (e.g., in-progress, resolved, pending, escalated). Reflects business workflow.","nullable":false},{"name":"event_comment","type":"string","description":"Business comment or event details. Free text, may contain user/admin message or reason for audit.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp of the event creation for timeline ordering and reporting.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete. Indicates record logically removed for data retention purposes.","nullable":true}],"uniqueIndexes":[{"fieldNames":["created_at","event_type"],"unique":true}],"plainIndexes":[{"fieldNames":["event_type"]},{"fieldNames":["created_at"]},{"fieldNames":["event_status"]}],"ginIndexes":[{"fieldName":"event_comment"}]},{"name":"shopping_mall_escalations","description":"Primary case file for escalated customer service requests, such as disputes, complex complaints, or cases requiring admin/special handling. Escalation is opened when regular service or user workflow is insufficient to resolve an issue. Tied to specific orders and one or more actors (customer, seller, admin) with independent case lifecycle for searching, filtering, and resolution tracking.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_order_id","type":"uuid","description":"Subject order's {@link shopping_mall_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_orders"},"unique":false,"nullable":false},{"name":"initiator_customer_id","type":"uuid","description":"Initiator customer's {@link shopping_mall_customers.id}, if case opened by customer.","relation":{"name":"initiatorCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"initiator_seller_id","type":"uuid","description":"Initiator seller's {@link shopping_mall_sellers.id}, if case opened by seller.","relation":{"name":"initiatorSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"assigned_admin_id","type":"uuid","description":"Assigned admin's {@link shopping_mall_admins.id} overseeing/owning this escalation.","relation":{"name":"assignedAdmin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"escalation_type","type":"string","description":"Type or reason for the escalation (e.g., 'payment dispute', 'order not received', 'refund delay').","nullable":false},{"name":"escalation_status","type":"string","description":"Current status of the escalation case (e.g., pending, in-review, resolved, closed, escalated-to-admin).","nullable":false},{"name":"resolution_type","type":"string","description":"Outcome or method of case closure/resolution (e.g., 'refund-issued', 'denied', 'order-resent', 'goodwill-credit').","nullable":true},{"name":"resolution_comment","type":"string","description":"Comment or explanation about resolution, for audit/postmortem/review.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp of case creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update in escalation case for workflow tracking.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete. Indicates case logically removed for data retention.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_order_id","escalation_type","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["escalation_status"]},{"fieldNames":["created_at"]},{"fieldNames":["assigned_admin_id"]}],"ginIndexes":[{"fieldName":"resolution_comment"}]},{"name":"shopping_mall_appeals","description":"Primary record for appeals on escalated customer service cases or admin/seller actions already taken. Represents user's attempt to seek additional review or override of prior decision. Linked to previous escalation, relevant actors, and independent case lifecycle. Allows independent searching, filtering, and tracking for reporting and compliance.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"escalation_id","type":"uuid","description":"Related escalation's {@link shopping_mall_escalations.id} being appealed.","relation":{"name":"escalation","targetModel":"shopping_mall_escalations"},"unique":false,"nullable":false},{"name":"appellant_customer_id","type":"uuid","description":"Appellant customer's {@link shopping_mall_customers.id}, if a customer files the appeal.","relation":{"name":"appellantCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"appellant_seller_id","type":"uuid","description":"Appellant seller's {@link shopping_mall_sellers.id}, if a seller files the appeal.","relation":{"name":"appellantSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"reviewing_admin_id","type":"uuid","description":"Admin's {@link shopping_mall_admins.id} reviewing/owning this appeal.","relation":{"name":"reviewingAdmin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"appeal_type","type":"string","description":"Type or nature of the appeal (e.g., 'refund denied', 'order closure challenge', 'policy review request').","nullable":false},{"name":"appeal_status","type":"string","description":"Current status of the appeal (e.g., pending, under review, resolved, dismissed, accepted, rejected).","nullable":false},{"name":"resolution_type","type":"string","description":"Outcome/method of appeal closure or review (e.g., 'refund-granted', 'upheld-denial', 'manual override').","nullable":true},{"name":"resolution_comment","type":"string","description":"Commentary on final appeal result, admin reason, or outcome note.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when appeal was filed.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp for last status update or workflow transition in appeal.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete. Indicates appeal logically removed for data retention policy.","nullable":true}],"uniqueIndexes":[{"fieldNames":["escalation_id","appeal_type","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["appeal_status"]},{"fieldNames":["created_at"]},{"fieldNames":["reviewing_admin_id"]}],"ginIndexes":[{"fieldName":"resolution_comment"}]}]},{"filename":"schema-08-admin.prisma","namespace":"Admin","models":[{"name":"shopping_mall_admin_action_logs","description":"Records all administrative actions performed on the platform (approvals, bans, suspensions, overrides, etc.) for compliance, transparency, and audit purposes. Each log links to the acting admin ({@link shopping_mall_admins}), the affected entity (customer, seller, product, order, or review), with domain information embedded. Used for investigation, reporting, and full platform accountability.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_admin_id","type":"uuid","description":"Acting admin's {@link shopping_mall_admins.id}.","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":false},{"name":"affected_customer_id","type":"uuid","description":"Affected customer's {@link shopping_mall_customers.id}, if applicable.","relation":{"name":"affectedCustomer","targetModel":"shopping_mall_customers"},"unique":false,"nullable":true},{"name":"affected_seller_id","type":"uuid","description":"Affected seller's {@link shopping_mall_sellers.id}, if applicable.","relation":{"name":"affectedSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"affected_product_id","type":"uuid","description":"Affected product's {@link shopping_mall_products.id}, if applicable.","relation":{"name":"affectedProduct","targetModel":"shopping_mall_products"},"unique":false,"nullable":true},{"name":"affected_order_id","type":"uuid","description":"Affected order's {@link shopping_mall_orders.id}, if applicable.","relation":{"name":"affectedOrder","targetModel":"shopping_mall_orders"},"unique":false,"nullable":true},{"name":"affected_review_id","type":"uuid","description":"Affected review's {@link shopping_mall_reviews.id}, if applicable.","relation":{"name":"affectedReview","targetModel":"shopping_mall_reviews"},"unique":false,"nullable":true}],"plainFields":[{"name":"action_type","type":"string","description":"Type of admin action (e.g., approval, ban, suspend, override, edit, restore, etc.).","nullable":false},{"name":"action_reason","type":"string","description":"Reason for the admin action. Required for compliance and audit.","nullable":false},{"name":"domain","type":"string","description":"Domain or entity type affected (customer, seller, product, order, review, system, etc.)","nullable":false},{"name":"details_json","type":"string","description":"Serialized JSON with structured context for the action: pre/post values, audit context.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp of log creation (action performed).","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_admin_id"]},{"fieldNames":["affected_customer_id"]},{"fieldNames":["affected_seller_id"]},{"fieldNames":["affected_product_id"]},{"fieldNames":["affected_order_id"]},{"fieldNames":["affected_review_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"details_json"}]},{"name":"shopping_mall_admin_audit_logs","description":"Long-retention, immutable logs of all critical platform-wide administrative actions/events for compliance, investigations, and regulatory review. Covers logins, permission grants, system settings changes, configuration edits, and explicit admin actions. Linked to admin, domain object, event type, and holds full context for audits.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_admin_id","type":"uuid","description":"Acting admin's {@link shopping_mall_admins.id} who triggered the event.","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":false}],"plainFields":[{"name":"audit_event_type","type":"string","description":"Type of audit event (login, permission_grant, system_setting, etc.).","nullable":false},{"name":"domain","type":"string","description":"Domain of admin action (platform, user_management, orders, products, etc.).","nullable":false},{"name":"event_context_json","type":"string","description":"Serialized JSON context for the event, including before/after states if applicable.","nullable":true},{"name":"log_level","type":"string","description":"Audit log level (info, warning, critical, etc.).","nullable":false},{"name":"created_at","type":"datetime","description":"Time of admin action/sensitive event for audit record.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_admin_id"]},{"fieldNames":["domain"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"event_context_json"}]},{"name":"shopping_mall_moderation_event_logs","description":"Logs for all moderation and exception events on platform entities (products, reviews, sellers, orders). Used for operational review, moderation queue tracking, and disciplinary records. Linked to admin who performed moderation, the affected entity (by foreign key), event type, and holds a message/reason for the moderation action.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_admin_id","type":"uuid","description":"Admin who performed the moderation ({@link shopping_mall_admins.id}).","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":false},{"name":"affected_seller_id","type":"uuid","description":"Affected seller ({@link shopping_mall_sellers.id}), if relevant.","relation":{"name":"affectedSeller","targetModel":"shopping_mall_sellers"},"unique":false,"nullable":true},{"name":"affected_product_id","type":"uuid","description":"Affected product ({@link shopping_mall_products.id}), if relevant.","relation":{"name":"affectedProduct","targetModel":"shopping_mall_products"},"unique":false,"nullable":true},{"name":"affected_review_id","type":"uuid","description":"Affected review ({@link shopping_mall_reviews.id}), if relevant.","relation":{"name":"affectedReview","targetModel":"shopping_mall_reviews"},"unique":false,"nullable":true},{"name":"affected_order_id","type":"uuid","description":"Affected order ({@link shopping_mall_orders.id}), if relevant.","relation":{"name":"affectedOrder","targetModel":"shopping_mall_orders"},"unique":false,"nullable":true}],"plainFields":[{"name":"event_type","type":"string","description":"Moderation event type (flag, removal, approval, annotation, warning, escalation, etc.).","nullable":false},{"name":"moderation_message","type":"string","description":"Admin-provided message or reason for the moderation or exception action.","nullable":false},{"name":"created_at","type":"datetime","description":"Event creation timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_admin_id"]},{"fieldNames":["affected_seller_id"]},{"fieldNames":["affected_product_id"]},{"fieldNames":["affected_review_id"]},{"fieldNames":["affected_order_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_notification_jobs","description":"Records for scheduled or executed platform notification jobs (email, SMS, push, in-app), including job config, status, retries, targeting, and results. Used for monitoring, failure re-processing, and notification delivery audit. Linked to admin or system if scheduled via dashboard.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_admin_id","type":"uuid","description":"Admin who scheduled/triggered the notification job ({@link shopping_mall_admins.id}), if applicable.","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"job_type","type":"string","description":"Type of notification job (email, sms, push, in_app, etc.).","nullable":false},{"name":"job_status","type":"string","description":"Job execution status (pending, running, success, failed, cancelled).","nullable":false},{"name":"target_json","type":"string","description":"Serialized JSON array of target entity references (user IDs, segments, topics, etc.).","nullable":false},{"name":"config_json","type":"string","description":"Serialized job configuration details (template, schedule, retry logic, etc.).","nullable":true},{"name":"result_json","type":"string","description":"Serialized result (success/failure logs, per-recipient status, error details).","nullable":true},{"name":"created_at","type":"datetime","description":"Job creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last job update (status, retries, etc.).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time for eventual cleanup, if needed.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["job_type"]},{"fieldNames":["job_status"]},{"fieldNames":["created_at"]},{"fieldNames":["deleted_at"]}],"ginIndexes":[{"fieldName":"target_json"},{"fieldName":"result_json"}]},{"name":"shopping_mall_analytics_triggers","description":"Platform-level scheduled analytics or reporting triggers for dashboards, exports, or periodic aggregation. Each record represents a logical analytics run, trigger, or export job, with schedule config, status, and outcome logs. Enables comprehensive monitoring and diagnostics of analytics functions, linked to scheduling admin if set manually.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_admin_id","type":"uuid","description":"Admin who configured/scheduled the analytics trigger ({@link shopping_mall_admins.id}), if applicable.","relation":{"name":"admin","targetModel":"shopping_mall_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"trigger_type","type":"string","description":"Analytics or aggregation trigger type (dashboard_update, report_export, data_rebuild, etc.).","nullable":false},{"name":"schedule_config_json","type":"string","description":"Serialized JSON for trigger schedule and config.","nullable":true},{"name":"status","type":"string","description":"Trigger/job status (pending, running, success, failed, cancelled).","nullable":false},{"name":"outcome_log_json","type":"string","description":"JSON log of analytics results or errors.","nullable":true},{"name":"created_at","type":"datetime","description":"Trigger/job creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Trigger/job last updated timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time for archival/cleanup, if applicable.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["trigger_type"]},{"fieldNames":["status"]},{"fieldNames":["created_at"]},{"fieldNames":["deleted_at"]}],"ginIndexes":[{"fieldName":"outcome_log_json"}]}]}]}
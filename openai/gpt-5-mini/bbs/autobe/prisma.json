{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"econ_political_forum_categories","description":"Categories for econPoliticalForum. Represents the canonical classification of threads and content. Categories drive visibility rules (public, moderated, restricted), may require verification for posting, and are referenced by threads and moderation workflows. Contains business identifiers (code, slug), display metadata, and flags used by content gating and moderator routing.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","nullable":true,"description":"Optional short business code for the category (e.g., 'fiscal', 'trade'). Unique when present."},{"name":"name","type":"string","nullable":false,"description":"Human-visible category name (for display in UI and navigation)."},{"name":"slug","type":"string","nullable":false,"description":"URL-friendly unique slug for the category (used for routing and lookups)."},{"name":"description","type":"string","nullable":true,"description":"Longer textual description explaining the purpose and scope of the category."},{"name":"is_moderated","type":"boolean","nullable":false,"description":"Whether new posts in this category require moderator approval before public publishing."},{"name":"requires_verification","type":"boolean","nullable":false,"description":"If true, posting in this category requires a verified account (email verified or other verification)."},{"name":"order","type":"int","nullable":false,"description":"Display order hint for UI lists; lower values are shown earlier."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp; null when active."}],"uniqueIndexes":[{"fieldNames":["slug"],"unique":true},{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["is_moderated","order"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"name"},{"fieldName":"description"}]},{"name":"econ_political_forum_site_settings","description":"Site-level configuration settings for econPoliticalForum. Key/value pairs used by application code and business logic to control runtime behavior, feature gating defaults, moderation thresholds, and environment-specific overrides. Intended to be small, read-mostly, and administrable via an admin UI. Keys must be unique.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"key","type":"string","nullable":false,"description":"Unique configuration key (namespace.form). Example: 'moderation.report_threshold'."},{"name":"value","type":"string","nullable":false,"description":"Configuration value stored as string. Typed interpretation handled by application logic (boolean/int/json as needed)."},{"name":"description","type":"string","nullable":true,"description":"Human-readable description and intent of the setting for administrators."},{"name":"environment","type":"string","nullable":true,"description":"Optional environment tag (e.g., 'production', 'staging') to scope overrides."},{"name":"is_public","type":"boolean","nullable":false,"description":"Whether this setting is visible to non-admin clients/UI (for example for feature exposure)."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp; null when active."}],"uniqueIndexes":[{"fieldNames":["key"],"unique":true}],"plainIndexes":[{"fieldNames":["environment","key"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"econ_political_forum_feature_flags","description":"Runtime feature flags controlling experimental features, gradual rollouts, and admin toggles. This table is read-mostly and is consulted at runtime to enable/disable features per key. Includes rollout percentage for progressive exposure and an administrable description. Keys are unique.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"key","type":"string","nullable":false,"description":"Unique feature flag key (e.g., 'new_search_ui')."},{"name":"enabled","type":"boolean","nullable":false,"description":"Whether the feature is currently enabled globally."},{"name":"rollout_percentage","type":"int","nullable":true,"description":"Optional rollout percentage (0-100) used for gradual exposure to a subset of users; null indicates not used."},{"name":"description","type":"string","nullable":true,"description":"Human-readable description explaining the feature and purpose."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp; null when active."}],"uniqueIndexes":[{"fieldNames":["key"],"unique":true}],"plainIndexes":[{"fieldNames":["enabled","created_at"]}],"ginIndexes":[]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"econ_political_forum_guest","description":"Lightweight guest identity record for unauthenticated or ephemeral visitors. Guests can browse and may file reports but cannot create persistent content. Stored to support anonymous or limited interactions and moderation traceability. Linked content references should point to specific actor tables when applicable. This table is primarily for tracking ephemeral identities and basic metadata.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"nickname","type":"string","nullable":true,"description":"Optional display nickname provided by the guest for ephemeral identification in a session. Not verified."},{"name":"user_agent","type":"string","nullable":true,"description":"User-agent string captured at first interaction for basic device/context information."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp for the guest record."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp. Null if active."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["created_at","nickname"]}],"ginIndexes":[{"fieldName":"nickname"}]},{"name":"econ_political_forum_registereduser","description":"Primary persistent registered user account. Contains authentication and profile fields used throughout the platform. Supports email/password or external auth (password_hash nullable). Includes verification and lockout fields to support email verification, account lockout policies, and basic security telemetry. Uniqueness enforced on username and email.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"username","type":"string","nullable":false,"description":"Unique account username used for login and display (normalized)."},{"name":"email","type":"string","nullable":false,"description":"Verified email address for account recovery and notifications."},{"name":"password_hash","type":"string","nullable":true,"description":"Password hash for local authentication. Nullable for accounts created via external OAuth providers."},{"name":"display_name","type":"string","nullable":true,"description":"Optional display name shown publicly; may differ from username."},{"name":"bio","type":"string","nullable":true,"description":"Optional short biography or profile description."},{"name":"avatar_uri","type":"uri","nullable":true,"description":"URI to user's avatar image (may be proxied via CDN)."},{"name":"is_banned","type":"boolean","nullable":false,"description":"Flag indicating whether the account is currently banned."},{"name":"banned_until","type":"datetime","nullable":true,"description":"Optional suspension expiry timestamp when temporarily banned."},{"name":"email_verified","type":"boolean","nullable":false,"description":"Whether the account's email has been verified (true) or not (false)."},{"name":"verified_at","type":"datetime","nullable":true,"description":"Timestamp when the account's email was verified; null if not verified."},{"name":"failed_login_attempts","type":"int","nullable":false,"description":"Rolling counter of recent failed login attempts used to enforce temporary lockouts."},{"name":"locked_until","type":"datetime","nullable":true,"description":"If present, authentication is blocked until this timestamp as part of lockout policy."},{"name":"last_login_at","type":"datetime","nullable":true,"description":"Most recent successful login timestamp for security analytics."},{"name":"created_at","type":"datetime","nullable":false,"description":"Account creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last profile update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp for account deletion requests or anonymization."}],"uniqueIndexes":[{"fieldNames":["username"],"unique":true},{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at","username"]},{"fieldNames":["display_name","updated_at"]},{"fieldNames":["failed_login_attempts","locked_until"]}],"ginIndexes":[{"fieldName":"display_name"}]},{"name":"econ_political_forum_moderator","description":"Moderator role record linking back to a registered user. Stores moderator-specific metadata such as assignment, active status, and moderation scope. The registereduser_id is unique enforcing a 1:1 relationship between a moderator record and the registered user identity.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Linked registered user identity. {@link econ_political_forum_registereduser.id}.","relation":{"name":"registereduser","targetModel":"econ_political_forum_registereduser"},"unique":true,"nullable":false}],"plainFields":[{"name":"is_active","type":"boolean","nullable":false,"description":"Whether the moderator is active and assigned to triage duties."},{"name":"assigned_at","type":"datetime","nullable":true,"description":"Timestamp when moderator privileges were granted or assigned."},{"name":"scope_notes","type":"string","nullable":true,"description":"Optional notes describing moderator scope or jurisdiction (e.g., categories assigned)."},{"name":"created_at","type":"datetime","nullable":false,"description":"Moderator record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp for moderator metadata."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp if moderator privileges are revoked and record retained for audit."}],"uniqueIndexes":[{"fieldNames":["registereduser_id"],"unique":true}],"plainIndexes":[{"fieldNames":["is_active","assigned_at"]}],"ginIndexes":[]},{"name":"econ_political_forum_administrator","description":"Administrator role record linking to a registered user. Stores admin-specific metadata and flags for global privileges. This enforces a 1:1 mapping to a registered user to centralize identity while separating admin attributes and auditability.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Linked registered user identity. {@link econ_political_forum_registereduser.id}.","relation":{"name":"registereduser","targetModel":"econ_political_forum_registereduser"},"unique":true,"nullable":false}],"plainFields":[{"name":"is_super","type":"boolean","nullable":false,"description":"Flag indicating whether the administrator has full (super) privileges."},{"name":"notes","type":"string","nullable":true,"description":"Optional administrative notes for audit or delegation purposes."},{"name":"created_at","type":"datetime","nullable":false,"description":"Administrator record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp for admin metadata."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp used when admin privileges are revoked while preserving audit trail."}],"uniqueIndexes":[{"fieldNames":["registereduser_id"],"unique":true}],"plainIndexes":[{"fieldNames":["is_super","created_at"]}],"ginIndexes":[]},{"name":"econ_political_forum_sessions","description":"Session records for registered users. Stores session tokens, expiration, client metadata, and last activity to enable session revocation and rotation. This is a subsidiary table managed through the registered user lifecycle APIs and is not a primary business entity by itself.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Owning registered user. {@link econ_political_forum_registereduser.id}.","relation":{"name":"registereduser","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false}],"plainFields":[{"name":"session_token","type":"string","nullable":false,"description":"Opaque session token or token identifier used for session validation. Should be unique per active session."},{"name":"refresh_token_hash","type":"string","nullable":true,"description":"Hash of refresh token for rotation and verification; storing hash improves security."},{"name":"ip_address","type":"string","nullable":true,"description":"IP address observed at session creation for risk analysis and security logs."},{"name":"user_agent","type":"string","nullable":true,"description":"User agent string captured at session creation."},{"name":"last_active_at","type":"datetime","nullable":true,"description":"Timestamp of the last observed activity for the session."},{"name":"expires_at","type":"datetime","nullable":false,"description":"Session expiry timestamp."},{"name":"created_at","type":"datetime","nullable":false,"description":"Session creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp for session record."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp for revoked sessions retained for audit."}],"uniqueIndexes":[{"fieldNames":["session_token"],"unique":true}],"plainIndexes":[{"fieldNames":["registereduser_id","created_at"]},{"fieldNames":["expires_at","last_active_at"]}],"ginIndexes":[]},{"name":"econ_political_forum_password_resets","description":"Password reset requests for registered users. Stores a single-use reset token (or its hash), expiry, usage flag, and timestamps. This is a subsidiary table used by account recovery flows and is managed through registered user lifecycle operations.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Target registered user for the password reset request. {@link econ_political_forum_registereduser.id}.","relation":{"name":"registereduser","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false}],"plainFields":[{"name":"reset_token_hash","type":"string","nullable":false,"description":"Hash of the single-use reset token. Storing a hash avoids storing plaintext tokens."},{"name":"expires_at","type":"datetime","nullable":false,"description":"Expiry timestamp for the reset token."},{"name":"used","type":"boolean","nullable":false,"description":"Flag indicating whether the reset token has been consumed."},{"name":"used_at","type":"datetime","nullable":true,"description":"Timestamp when the token was consumed, if applicable."},{"name":"created_at","type":"datetime","nullable":false,"description":"Creation timestamp for the password reset request."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp for expired or revoked reset requests kept for audit."}],"uniqueIndexes":[{"fieldNames":["reset_token_hash"],"unique":true}],"plainIndexes":[{"fieldNames":["registereduser_id","created_at"]}],"ginIndexes":[]}]},{"filename":"schema-03-content.prisma","namespace":"Content","models":[{"name":"econ_political_forum_threads","description":"Discussion threads (top-level topics). Canonical thread metadata only â€” no pre-calculated aggregates. Refer to category ({@link econ_political_forum_categories.id}) and author ({@link econ_political_forum_registereduser.id}). Temporal fields included for audit and soft-delete. Counters (view_count, post_count) removed per normalization rules; use materialized views (mv_*) for aggregates.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"category_id","type":"uuid","description":"Belonged category. {@link econ_political_forum_categories.id}.","relation":{"name":"category","targetModel":"econ_political_forum_categories"},"unique":false,"nullable":false},{"name":"author_id","type":"uuid","description":"Authoring registered user. {@link econ_political_forum_registereduser.id}.","relation":{"name":"author","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","nullable":false,"description":"Thread title used for listing and search."},{"name":"slug","type":"string","nullable":false,"description":"URL-friendly identifier for the thread (unique)."},{"name":"status","type":"string","nullable":false,"description":"Thread lifecycle status (e.g., 'open','closed','pinned')."},{"name":"pinned","type":"boolean","nullable":false,"description":"Whether the thread is pinned for prominent display."},{"name":"created_at","type":"datetime","nullable":false,"description":"Creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp; null when active."}],"uniqueIndexes":[{"fieldNames":["slug"],"unique":true}],"plainIndexes":[{"fieldNames":["category_id","created_at"]},{"fieldNames":["author_id","created_at"]}],"ginIndexes":[{"fieldName":"title"}]},{"name":"econ_political_forum_posts","description":"Posts and replies belonging to threads. Canonical post content only (no cached counters or rendered HTML). Parent relation kept for replies. Revision history stored in econ_political_forum_post_revisions (snapshot). Removed derived fields (vote_count, upvote_count, downvote_count, content_html) to comply with normalization rules; move aggregates to materialized views.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"thread_id","type":"uuid","description":"Belonged thread. {@link econ_political_forum_threads.id}.","relation":{"name":"thread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":false},{"name":"author_id","type":"uuid","description":"Authoring registered user. {@link econ_political_forum_registereduser.id}.","relation":{"name":"author","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false},{"name":"parent_id","type":"uuid","description":"Optional parent post for replies. {@link econ_political_forum_posts.id}.","relation":{"name":"parent","targetModel":"econ_political_forum_posts","mappingName":"recursive"},"unique":false,"nullable":true}],"plainFields":[{"name":"content","type":"string","nullable":false,"description":"Raw post content (plaintext or sanitized markdown)."},{"name":"is_edited","type":"boolean","nullable":false,"description":"Flag indicating whether the post was edited after creation."},{"name":"edited_at","type":"datetime","nullable":true,"description":"Timestamp of the latest edit; null if never edited."},{"name":"is_hidden","type":"boolean","nullable":false,"description":"Moderator hide flag; when true the post is not shown in public listings."},{"name":"created_at","type":"datetime","nullable":false,"description":"Creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp; null when active."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["thread_id","created_at"]},{"fieldNames":["author_id","created_at"]},{"fieldNames":["parent_id"]},{"fieldNames":["thread_id","is_hidden","created_at"]}],"ginIndexes":[{"fieldName":"content"}]},{"name":"econ_political_forum_post_revisions","description":"Append-only revision history for posts. Each revision captures the full post content at a point in time, the editor (if different from author), and a created_at timestamp. This table is snapshot-like and intended for audit/history and moderator review.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"post_id","type":"uuid","description":"Referenced post. {@link econ_political_forum_posts.id}.","relation":{"name":"post","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":false},{"name":"editor_id","type":"uuid","description":"Editor (registered user) who made the revision, if applicable. {@link econ_political_forum_registereduser.id}.","relation":{"name":"editor","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":true}],"plainFields":[{"name":"content","type":"string","nullable":false,"description":"Full post content snapshot at the time of revision."},{"name":"note","type":"string","nullable":true,"description":"Optional short editor note describing the change."},{"name":"created_at","type":"datetime","nullable":false,"description":"Revision timestamp (when the snapshot was recorded)."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["post_id","created_at"]}],"ginIndexes":[{"fieldName":"content"}]}]},{"filename":"schema-04-taxonomy.prisma","namespace":"Taxonomy","models":[{"name":"econ_political_forum_tags","description":"Normalized tag catalog used for discovery and search across the econPoliticalForum. Each tag is a primary, independently managed entity. Tags are referenced by threads through the join table {@link econ_political_forum_thread_tags}. Includes temporal fields for auditing and soft-delete support.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"Human-readable tag name. Examples: 'fiscal-policy', 'inflation'. Normalized and unique."},{"name":"slug","type":"string","nullable":false,"description":"URL-safe lower-case slug for the tag. Unique and indexed for fast lookup."},{"name":"description","type":"string","nullable":true,"description":"Optional longer description of the tag's purpose or scope."},{"name":"created_at","type":"datetime","nullable":false,"description":"Creation timestamp (UTC)."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp (UTC)."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp. Null when active."}],"uniqueIndexes":[{"fieldNames":["slug"],"unique":true},{"fieldNames":["name"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"description"}]},{"name":"econ_political_forum_thread_tags","description":"Join table mapping threads to tags. Renamed foreign key field to tag_id for naming consistency and added index optimized for tag->threads lookups. Preserves UUID primary key, created_at and soft-delete fields for audit. References: {@link econ_political_forum_threads.id}, {@link econ_political_forum_tags.id}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"thread_id","type":"uuid","description":"Belonged thread. {@link econ_political_forum_threads.id}.","relation":{"name":"thread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":false},{"name":"tag_id","type":"uuid","description":"Belonged tag. {@link econ_political_forum_tags.id}.","relation":{"name":"tag","targetModel":"econ_political_forum_tags"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the tag was attached to the thread."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp for the join. Null when active."}],"uniqueIndexes":[{"fieldNames":["thread_id","tag_id"],"unique":true}],"plainIndexes":[{"fieldNames":["tag_id","thread_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[]}]},{"filename":"schema-05-interactions.prisma","namespace":"Interactions","models":[{"name":"econ_political_forum_votes","description":"User votes on posts. One vote per user per post is enforced via a composite unique constraint. Stores vote value (application-enforced domain: 1 = upvote, -1 = downvote), timestamps, and soft-delete to support audit and rollback. References {@link econ_political_forum_registereduser.id} and {@link econ_political_forum_posts.id}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Owning registered user's {@link econ_political_forum_registereduser.id}.","relation":{"name":"registeredUser","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false},{"name":"post_id","type":"uuid","description":"Target post's {@link econ_political_forum_posts.id}.","relation":{"name":"post","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":false}],"plainFields":[{"name":"value","type":"int","nullable":false,"description":"Vote value. Business domain: 1 = upvote, -1 = downvote. Application should validate allowed values; consider DB CHECK or string enum if preferred."},{"name":"created_at","type":"datetime","nullable":false,"description":"Creation timestamp for the vote record."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update time for the vote record (used when vote is changed)."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp; null when active."}],"uniqueIndexes":[{"fieldNames":["registereduser_id","post_id"],"unique":true}],"plainIndexes":[{"fieldNames":["post_id","created_at"]},{"fieldNames":["registereduser_id","created_at"]}],"ginIndexes":[]},{"name":"econ_political_forum_bookmarks","description":"User bookmarks (saved posts). Enforces one bookmark per user per post via composite unique constraint. Soft-delete used to allow unbookmark while preserving an audit trail. References {@link econ_political_forum_registereduser.id} and {@link econ_political_forum_posts.id}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Owning registered user's {@link econ_political_forum_registereduser.id}.","relation":{"name":"registeredUser","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false},{"name":"post_id","type":"uuid","description":"Bookmarked post's {@link econ_political_forum_posts.id}.","relation":{"name":"post","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","nullable":false,"description":"Bookmark creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update time for the bookmark (if metadata changes)."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp; null when bookmark is active."}],"uniqueIndexes":[{"fieldNames":["registereduser_id","post_id"],"unique":true}],"plainIndexes":[{"fieldNames":["post_id","created_at"]},{"fieldNames":["registereduser_id","created_at"]}],"ginIndexes":[]},{"name":"econ_political_forum_thread_follows","description":"Tracks thread subscriptions (follows) by users for notification and feed generation. Enforces one follow per user per thread. Includes optional muted_until for temporary notification suppression. References {@link econ_political_forum_registereduser.id} and {@link econ_political_forum_threads.id}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Owning registered user's {@link econ_political_forum_registereduser.id}.","relation":{"name":"registeredUser","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":false},{"name":"thread_id","type":"uuid","description":"Followed thread's {@link econ_political_forum_threads.id}.","relation":{"name":"thread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the follow was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update time for the follow (e.g., mute toggles)."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp; null when follow is active."},{"name":"muted_until","type":"datetime","nullable":true,"description":"Optional timestamp until which notifications for this follow are muted."}],"uniqueIndexes":[{"fieldNames":["registereduser_id","thread_id"],"unique":true}],"plainIndexes":[{"fieldNames":["thread_id","created_at"]},{"fieldNames":["registereduser_id","created_at"]}],"ginIndexes":[]}]},{"filename":"schema-06-moderation.prisma","namespace":"Moderation","models":[{"name":"econ_political_forum_reports","description":"Structured user reports of potentially violating content (post or thread). Captures reporter identity (when available), selected reason code, optional reporter details, linkage to target content (post or thread), current processing status, moderation_case association, and SLA timestamps for triage and review. Adjusted to ensure referential integrity and audit preservation: reporter FK uses SET NULL semantics (preserve reports if user removed), removed incorrect generated reverse-array relation, and added composite indexes and GIN index for search. Includes explicit temporal fields and soft-delete for retention. {@link econ_political_forum_posts.id} {@link econ_political_forum_threads.id} {@link econ_political_forum_registereduser.id}","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reporter_id","type":"uuid","description":"Reporting user's {@link econ_political_forum_registereduser.id}. Null if reporter requested anonymity or is unauthenticated.","relation":{"name":"reporter","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":true},{"name":"reported_post_id","type":"uuid","description":"Target post's {@link econ_political_forum_posts.id}. Nullable if the report targets a thread instead.","relation":{"name":"reportedPost","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":true},{"name":"reported_thread_id","type":"uuid","description":"Target thread's {@link econ_political_forum_threads.id}. Nullable if the report targets a post.","relation":{"name":"reportedThread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":true},{"name":"moderator_id","type":"uuid","description":"Reviewing moderator's {@link econ_political_forum_moderator.id}. Populated when a moderator triages or acts on the report.","relation":{"name":"moderator","targetModel":"econ_political_forum_moderator"},"unique":false,"nullable":true},{"name":"moderation_case_id","type":"uuid","description":"Associated moderation case {@link econ_political_forum_moderation_cases.id} aggregating related reports for admin review.","relation":{"name":"moderationCase","targetModel":"econ_political_forum_moderation_cases"},"unique":false,"nullable":true}],"plainFields":[{"name":"reason_code","type":"string","nullable":false,"description":"Structured reason code selected by the reporter (e.g., 'harassment','doxxing','misinformation','illegal_content','spam','other'). Stored as string for flexibility and clarity."},{"name":"reporter_text","type":"string","nullable":true,"description":"Optional free-text provided by reporter giving additional context (max 2000 chars recommended)."},{"name":"reporter_anonymous","type":"boolean","nullable":false,"description":"Whether the reporter requested anonymity from the content author/public. Moderators retain reporter identity in internal UI when available."},{"name":"status","type":"string","nullable":false,"description":"Processing state of the report (e.g., 'pending','triaged','dismissed','action_taken','escalated')."},{"name":"priority","type":"string","nullable":false,"description":"Operational priority label for triage (e.g., 'low','normal','high','urgent')."},{"name":"created_at","type":"datetime","nullable":false,"description":"Report creation timestamp (immutable)."},{"name":"triaged_at","type":"datetime","nullable":true,"description":"Timestamp when a moderator first acknowledged or triaged the report."},{"name":"reviewed_at","type":"datetime","nullable":true,"description":"Timestamp when a final review/action was recorded for the report."},{"name":"resolved_at","type":"datetime","nullable":true,"description":"Timestamp when the report was resolved (action taken or dismissed)."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp for the report record when removal is required. Use sparingly; legal holds may prevent deletion."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["status","created_at"]},{"fieldNames":["priority","created_at"]},{"fieldNames":["reported_post_id","status","created_at"]},{"fieldNames":["reported_thread_id","status","created_at"]},{"fieldNames":["moderation_case_id","created_at"]}],"ginIndexes":[{"fieldName":"reporter_text"}]},{"name":"econ_political_forum_moderation_logs","description":"Immutable moderation log entries recording actions taken by moderators or system actors. Each entry is append-only and includes actor reference, action type, linked content (post or thread), optional linkage to a moderation case, structured reason codes, and free-text rationale. Designed for legal audit, retention, and chronological reconstruction of moderation decisions. {@\\link econ_political_forum_moderator.id} {@\\link econ_political_forum_posts.id} {@\\link econ_political_forum_threads.id} {@\\link econ_political_forum_moderation_cases.id}","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"moderator_id","type":"uuid","description":"Acting moderator's {@\\link econ_political_forum_moderator.id}. Nullable for system or automated actions.","relation":{"name":"moderator","targetModel":"econ_political_forum_moderator"},"unique":false,"nullable":true},{"name":"target_post_id","type":"uuid","description":"Target post affected by the action ({@\\link econ_political_forum_posts.id}). Nullable if action targets a thread or user record.","relation":{"name":"targetPost","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":true},{"name":"target_thread_id","type":"uuid","description":"Target thread affected by the action ({@\\link econ_political_forum_threads.id}). Nullable if action targets a post.","relation":{"name":"targetThread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":true},{"name":"moderation_case_id","type":"uuid","description":"Associated moderation case {@\\link econ_political_forum_moderation_cases.id} for grouped investigations.","relation":{"name":"moderationCase","targetModel":"econ_political_forum_moderation_cases"},"unique":false,"nullable":true},{"name":"acted_admin_id","type":"uuid","description":"Acting administrator id when an admin performed or finalized the action ({@\\link econ_political_forum_administrator.id}). Nullable.","relation":{"name":"actedAdmin","targetModel":"econ_political_forum_administrator"},"unique":false,"nullable":true}],"plainFields":[{"name":"action_type","type":"string","description":"Type of moderation action (e.g., 'hide','remove','warning','suspend','approve','escalate','merge','flag').","nullable":false},{"name":"reason_code","type":"string","description":"Structured policy reason code applied by the moderator (maps to policy clauses).","nullable":false},{"name":"rationale","type":"string","description":"Moderator-provided free-text rationale explaining the action (up to recommended 1000 chars).","nullable":true},{"name":"evidence_reference","type":"string","description":"Optional URI or reference id pointing to stored evidence bundles or archived snapshots (could be internal object id or URL).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the moderation action was recorded (immutable).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-delete marker for the log entry (rare; prefer append-only retention).","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["moderator_id","created_at"]},{"fieldNames":["action_type","created_at"]}],"ginIndexes":[{"fieldName":"rationale"}]},{"name":"econ_political_forum_moderation_cases","description":"Moderation case entity that aggregates related reports and moderation logs for administrator investigation, escalation, and appeals processing. Contains operational metadata for triage, assignment, legal hold flagging, and case lifecycle timestamps. Cases provide a single coordination point for researchers and admins while preserving immutable moderation_logs for audit.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"assigned_moderator_id","type":"uuid","description":"Moderator assigned to manage the case {@link econ_political_forum_moderator.id}. Nullable when unassigned.","relation":{"name":"assignedModerator","targetModel":"econ_political_forum_moderator"},"unique":false,"nullable":true},{"name":"owner_admin_id","type":"uuid","description":"Administrator owner or final approver for the case {@link econ_political_forum_administrator.id}. Nullable.","relation":{"name":"ownerAdmin","targetModel":"econ_political_forum_administrator"},"unique":false,"nullable":true}],"plainFields":[{"name":"lead_report_id","type":"uuid","nullable":true,"description":"Representative report id that initiated the case {@link econ_political_forum_reports.id}. Stored as uuid rather than a DB-level foreign key to avoid circular dependency."},{"name":"case_number","type":"string","description":"Human-friendly unique case identifier used in operations and communication (e.g., 'CASE-2025-0001').","nullable":false},{"name":"title","type":"string","description":"Short case title summarizing the issue for quick identification.","nullable":true},{"name":"status","type":"string","description":"Lifecycle status of the case (e.g., 'open','investigating','closed','on_hold').","nullable":false},{"name":"priority","type":"string","description":"Operational priority label (e.g., 'low','normal','high','urgent').","nullable":false},{"name":"summary","type":"string","description":"Concise summary or executive note for the case; suitable for dashboards and quick reviews.","nullable":true},{"name":"escalation_reason","type":"string","description":"If escalated, the reason for escalation (e.g., 'legal','law_enforcement','coordinated_activity').","nullable":true},{"name":"legal_hold","type":"boolean","description":"Whether a legal hold applies to the case and associated evidence; when true archival/deletion operations must be inhibited.","nullable":false},{"name":"created_at","type":"datetime","description":"Case creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the case.","nullable":false},{"name":"closed_at","type":"datetime","description":"Timestamp when the case was closed/resolved.","nullable":true},{"name":"deleted_at","type":"datetime","description":"Soft-delete timestamp for the case record (rare).","nullable":true}],"uniqueIndexes":[{"fieldNames":["case_number"],"unique":true}],"plainIndexes":[{"fieldNames":["status","priority","created_at"]}],"ginIndexes":[{"fieldName":"summary"}]}]},{"filename":"schema-07-notifications.prisma","namespace":"Notifications","models":[{"name":"econ_political_forum_notifications","description":"User-facing notification events. Each record represents a single notification targeted to a registered user (recipient). Notifications are append-only events by business practice with soft-delete support. Records contain a small, flexible JSON payload (stored as string) for extensible delivery payloads (mentions, replies, moderation actions, system messages). Key relations: recipient ({@link econ_political_forum_registereduser.id}), optional actor ({@link econ_political_forum_registereduser.id}) who triggered the notification, and optional references to related domain entities (thread, post, moderation_case) stored as UUIDs for cross-component linkage. Optimized for fast per-recipient reads and supports marking notifications as read, delivery timestamps, and light audit fields.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Recipient registered user's {@link econ_political_forum_registereduser.id}.","relation":{"name":"recipient","targetModel":"econ_political_forum_registereduser","mappingName":"econ_political_forum_notifications_of_registereduser_id"},"unique":false,"nullable":false},{"name":"actor_registereduser_id","type":"uuid","description":"Optional actor (triggering user) {@link econ_political_forum_registereduser.id}. Nullable when system-generated.","relation":{"name":"actor","targetModel":"econ_political_forum_registereduser","mappingName":"econ_political_forum_notifications_of_actor_registereduser_id"},"unique":false,"nullable":true}],"plainFields":[{"name":"type","type":"string","nullable":false,"description":"Notification type code (e.g., 'mention', 'reply', 'moderation', 'system')."},{"name":"title","type":"string","nullable":true,"description":"Short human-readable title for the notification. Optional; used in UI summaries."},{"name":"body","type":"string","nullable":true,"description":"Optional short message body or plain-text excerpt for display in lists."},{"name":"payload","type":"string","nullable":false,"description":"Flexible JSON payload (serialized as string) containing structured delivery data (links to thread/post ids, excerpt, metadata)."},{"name":"is_read","type":"boolean","nullable":false,"description":"Whether the recipient has marked this notification as read."},{"name":"delivered_at","type":"datetime","nullable":true,"description":"When the notification was delivered to the user (for push/email). Nullable if not yet delivered or for in-app only events."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp. When set, notification is treated as removed from normal listings but retained for audit."},{"name":"related_thread_id","type":"uuid","nullable":true,"description":"Optional related thread id (referencing {@link econ_political_forum_threads.id}) stored as UUID for linkage. Nullable to avoid hard FK to other component in this schema file."},{"name":"related_post_id","type":"uuid","nullable":true,"description":"Optional related post id (referencing {@link econ_political_forum_posts.id}) stored as UUID for linkage."},{"name":"related_moderation_case_id","type":"uuid","nullable":true,"description":"Optional related moderation case id (referencing {@link econ_political_forum_moderation_cases.id}) stored as UUID for linkage."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["registereduser_id","created_at"]},{"fieldNames":["registereduser_id","is_read","created_at"]},{"fieldNames":["actor_registereduser_id"]},{"fieldNames":["related_thread_id","created_at"]},{"fieldNames":["related_post_id","created_at"]},{"fieldNames":["related_moderation_case_id","created_at"]}],"ginIndexes":[{"fieldName":"payload"}]},{"name":"econ_political_forum_notification_preferences","description":"Per-user notification delivery preferences. One row per registered user controls channel-level toggles (in-app, email, push) and a flexible JSON string for per-notification-type overrides. Designed to be small and infrequently updated; referenced when enqueuing or delivering notifications. Links to registered users via a one-to-one foreign key constraint.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Belonged registered user's {@link econ_political_forum_registereduser.id}. One-to-one relationship enforced with a unique constraint.","relation":{"name":"user","targetModel":"econ_political_forum_registereduser"},"unique":true,"nullable":false}],"plainFields":[{"name":"in_app","type":"boolean","nullable":false,"description":"Whether in-app notifications are enabled for the user."},{"name":"email","type":"boolean","nullable":false,"description":"Whether email notifications are enabled for the user."},{"name":"push","type":"boolean","nullable":false,"description":"Whether push notifications are enabled for the user."},{"name":"preferences_payload","type":"string","nullable":true,"description":"Optional JSON-serialized per-type preference overrides (e.g., {\"mentions\": {\"email\": false}}) stored as string for portability."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft-delete timestamp for preference records."}],"uniqueIndexes":[{"fieldNames":["registereduser_id"],"unique":true}],"plainIndexes":[{"fieldNames":["registereduser_id","updated_at"]}],"ginIndexes":[]}]},{"filename":"schema-08-audit.prisma","namespace":"Audit","models":[{"name":"econ_political_forum_audit_logs","description":"Immutable audit log entries capturing system and moderation events for compliance and incident investigation. Each record references acting principals and related objects (post, thread, report, moderation case). Relations intentionally use nullable foreign keys and MUST use SET NULL or RESTRICT on delete to preserve audit history when referenced objects are removed. This model is append-only and classified as a snapshot for retention and legal export workflows.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Acting user's {@link econ_political_forum_registereduser.id}. Nullable for system actions.","relation":{"name":"actor","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":true},{"name":"moderator_id","type":"uuid","description":"Acting moderator's {@link econ_political_forum_moderator.id}. Nullable when action is not by a moderator.","relation":{"name":"moderator","targetModel":"econ_political_forum_moderator"},"unique":false,"nullable":true},{"name":"post_id","type":"uuid","description":"Referenced post {@link econ_political_forum_posts.id}. Nullable to preserve audit when posts are removed.","relation":{"name":"post","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":true},{"name":"thread_id","type":"uuid","description":"Referenced thread {@link econ_political_forum_threads.id}. Nullable to preserve audit when threads are removed.","relation":{"name":"thread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":true},{"name":"report_id","type":"uuid","description":"Associated report {@link econ_political_forum_reports.id}. Nullable to preserve audit records independent of report lifecycle.","relation":{"name":"report","targetModel":"econ_political_forum_reports"},"unique":false,"nullable":true},{"name":"moderation_case_id","type":"uuid","description":"Associated moderation case {@link econ_political_forum_moderation_cases.id}. Nullable to preserve audit records independent of case lifecycle.","relation":{"name":"moderationCase","targetModel":"econ_political_forum_moderation_cases"},"unique":false,"nullable":true}],"plainFields":[{"name":"action_type","type":"string","nullable":false,"description":"Categorical action type (e.g., 'create', 'edit', 'delete', 'hide', 'warn', 'suspend', 'escalate', 'legal_disclosure')."},{"name":"target_type","type":"string","nullable":false,"description":"Type of target object (e.g., 'post','thread','user','report','moderation_case')."},{"name":"target_identifier","type":"string","nullable":true,"description":"Canonical identifier of the target as a string for cross-domain queries; nullable when not applicable."},{"name":"details","type":"string","nullable":true,"description":"Free-text or JSON-serialized details of the event (evidence snapshot, moderator rationale, metadata). Keep size reasonable; heavy binary artifacts should be stored externally and referenced by evidence_reference."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the audit entry was recorded (ISO 8601)."},{"name":"created_by_system","type":"boolean","nullable":false,"description":"Whether the entry was generated by an automated system (true) or by a human actor (false)."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["moderator_id","created_at"]},{"fieldNames":["thread_id","created_at"]},{"fieldNames":["report_id","created_at"]},{"fieldNames":["registereduser_id","created_at"]},{"fieldNames":["post_id","created_at"]},{"fieldNames":["target_type","created_at"]}],"ginIndexes":[{"fieldName":"details"}]},{"name":"econ_political_forum_legal_holds","description":"Legal hold records that prevent deletion or purging of content subject to legal or investigatory requirements. Holds must persist independently of target object lifecycle; relations use nullable FKs and application/DB logic must prevent purge while holds are active. Classified as subsidiary because holds support enforcement rather than user-facing CRUD.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"registereduser_id","type":"uuid","description":"Administrator or legal officer who placed the hold. {@link econ_political_forum_registereduser.id}. Nullable when placed by system/legal process.","relation":{"name":"holder","targetModel":"econ_political_forum_registereduser"},"unique":false,"nullable":true},{"name":"post_id","type":"uuid","description":"If the hold targets a specific post, reference to {@link econ_political_forum_posts.id}. Nullable when the hold targets a thread or case.","relation":{"name":"post","targetModel":"econ_political_forum_posts"},"unique":false,"nullable":true},{"name":"thread_id","type":"uuid","description":"If the hold targets a thread, reference to {@link econ_political_forum_threads.id}. Nullable when not applicable.","relation":{"name":"thread","targetModel":"econ_political_forum_threads"},"unique":false,"nullable":true},{"name":"moderation_case_id","type":"uuid","description":"Optional link to a related moderation case {@link econ_political_forum_moderation_cases.id} that motivated the hold.","relation":{"name":"moderationCase","targetModel":"econ_political_forum_moderation_cases"},"unique":false,"nullable":true}],"plainFields":[{"name":"hold_reason","type":"string","nullable":false,"description":"Short human-readable reason for the legal hold (e.g., 'subpoena', 'law enforcement request', 'litigation')."},{"name":"hold_start","type":"datetime","nullable":false,"description":"Timestamp when the hold became effective (ISO 8601)."},{"name":"hold_end","type":"datetime","nullable":true,"description":"Optional timestamp when the hold is scheduled to end; null if indefinite."},{"name":"is_active","type":"boolean","nullable":false,"description":"Whether the hold is currently active and prevents purging."},{"name":"notes","type":"string","nullable":true,"description":"Optional free-text notes or case identifiers for internal use; do not expose sensitive PII in this field without access controls."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the hold record was created."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["post_id","hold_start"]},{"fieldNames":["thread_id","hold_start"]},{"fieldNames":["registereduser_id"]},{"fieldNames":["is_active","hold_start"]}],"ginIndexes":[]}]}]}
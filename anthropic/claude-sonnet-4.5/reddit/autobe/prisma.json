{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"reddit_like_system_settings","description":"Platform-wide configuration settings stored as key-value pairs. This table contains system parameters that control platform behavior, such as content limits, rate limiting rules, feature toggles, and other configurable aspects of the system. Settings can be categorized and marked as public or internal-only. Values are stored as strings with a type indicator for proper deserialization.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"key","type":"string","description":"Unique identifier for the setting (e.g., 'max_post_length', 'rate_limit_posts_per_hour'). This key is used to retrieve the setting value throughout the application.","nullable":false},{"name":"value","type":"string","description":"The setting value stored as a string. Complex values (objects, arrays) can be stored as JSON strings. The value_type field indicates how to deserialize this value.","nullable":false},{"name":"description","type":"string","description":"Human-readable description explaining what this setting controls and its purpose. Helps administrators understand the impact of changing this setting.","nullable":true},{"name":"value_type","type":"string","description":"Indicates the data type of the value for proper deserialization. Common values: 'string', 'int', 'double', 'boolean', 'json'. This helps the application correctly parse the value string.","nullable":false},{"name":"category","type":"string","description":"Grouping category for organizing related settings (e.g., 'content', 'moderation', 'performance', 'features'). Allows filtering and grouping settings in admin interfaces.","nullable":true},{"name":"is_public","type":"boolean","description":"Whether this setting can be exposed via public API or is internal-only. Public settings may be displayed to users (e.g., max post length), while internal settings are admin-only (e.g., API keys, security parameters).","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when this setting was first created in the system.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when this setting was last modified. Updated whenever the value or other fields change. Provides audit trail for configuration changes.","nullable":false}],"uniqueIndexes":[{"fieldNames":["key"],"unique":true}],"plainIndexes":[{"fieldNames":["category"]},{"fieldNames":["is_public"]}],"ginIndexes":[]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"reddit_like_guests","description":"Guest users represent unauthenticated visitors to the platform. Guests can view public communities, posts, and comments but cannot interact through voting, posting, or commenting. This table tracks guest sessions for analytics and potential conversion to member accounts.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"session_identifier","type":"string","description":"Unique session identifier for tracking guest activity across visits. Used for analytics and anonymous user behavior tracking.","nullable":false},{"name":"ip_address","type":"string","description":"IP address of the guest user for security monitoring and rate limiting purposes.","nullable":true},{"name":"user_agent","type":"string","description":"Browser user agent string for device and browser analytics.","nullable":true},{"name":"first_visit_at","type":"datetime","description":"Timestamp of the guest's first visit to the platform.","nullable":false},{"name":"last_visit_at","type":"datetime","description":"Timestamp of the guest's most recent visit to the platform.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the guest session was first created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the guest session was last updated.","nullable":false}],"uniqueIndexes":[{"fieldNames":["session_identifier"],"unique":true}],"plainIndexes":[{"fieldNames":["last_visit_at"]}],"ginIndexes":[]},{"name":"reddit_like_members","description":"Member users are authenticated standard users with full participation rights. Members can create posts, write comments, vote on content, subscribe to communities, and earn karma. This is the core user type representing the majority of platform participants.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"username","type":"string","description":"Unique username chosen during registration. Must be 3-20 characters containing only alphanumeric characters, underscores, and hyphens. Displayed throughout the platform as the user's identity.","nullable":false},{"name":"email","type":"string","description":"Unique email address for authentication and communication. Used for login, verification, and notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Securely hashed password using bcrypt, Argon2, or PBKDF2. Never stored in plain text. Used for authentication.","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the user has verified their email address. Some features may require verified email status.","nullable":false},{"name":"profile_bio","type":"string","description":"Optional user biography or description displayed on their profile page. Limited to 200-500 characters.","nullable":true},{"name":"avatar_url","type":"string","description":"URL to the user's profile avatar image. Points to uploaded custom avatar or default generated avatar.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the member account was created. Displayed as account age on profile.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the member account was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp when the account was soft-deleted. Null if account is active. Enables account recovery and data preservation.","nullable":true}],"uniqueIndexes":[{"fieldNames":["username"],"unique":true},{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["email_verified"]}],"ginIndexes":[]},{"name":"reddit_like_moderators","description":"Moderator users are trusted community managers with elevated permissions within specific communities. Moderators can remove content, ban users from their communities, configure community settings, and enforce community rules. Moderator status is community-specific.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"username","type":"string","description":"Unique username for the moderator account. Same constraints as member usernames: 3-20 characters, alphanumeric with underscores and hyphens.","nullable":false},{"name":"email","type":"string","description":"Unique email address for moderator authentication and communication. Used for moderation notifications and alerts.","nullable":false},{"name":"password_hash","type":"string","description":"Securely hashed password for moderator authentication. Same security standards as member passwords.","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the moderator has verified their email address. Required for moderator privileges.","nullable":false},{"name":"profile_bio","type":"string","description":"Optional moderator biography displayed on their profile.","nullable":true},{"name":"avatar_url","type":"string","description":"URL to the moderator's profile avatar image.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the moderator account was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the moderator account was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp when the moderator account was soft-deleted. Null if account is active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["username"],"unique":true},{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["email_verified"]}],"ginIndexes":[]},{"name":"reddit_like_admins","description":"Administrator users are platform-level managers with system-wide elevated permissions. Admins can manage all communities, handle appeals, suspend users from the entire platform, and configure platform-wide settings. This represents the highest authority level.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"username","type":"string","description":"Unique username for the administrator account. Same constraints as other user types.","nullable":false},{"name":"email","type":"string","description":"Unique email address for administrator authentication and critical platform notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Securely hashed password for administrator authentication. Highest security standards required.","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the administrator has verified their email address. Required for admin privileges.","nullable":false},{"name":"profile_bio","type":"string","description":"Optional administrator biography displayed on their profile.","nullable":true},{"name":"avatar_url","type":"string","description":"URL to the administrator's profile avatar image.","nullable":true},{"name":"super_admin","type":"boolean","description":"Whether this administrator has super admin privileges for critical platform operations like managing other administrators.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the administrator account was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the administrator account was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp when the administrator account was soft-deleted. Null if account is active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["username"],"unique":true},{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["email_verified"]}],"ginIndexes":[]},{"name":"reddit_like_auth_credentials","description":"Authentication security metadata tracking failed login attempts, account locking, and login history for security monitoring. Supports rate limiting (max 5 failed attempts in 15 minutes triggers 30-minute lock) and suspicious activity detection. One credential record per user account for centralized auth security tracking.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_user_id","type":"uuid","description":"User account these credentials belong to. {@link reddit_like_users.id}","relation":{"name":"user","targetModel":"reddit_like_users"},"unique":true,"nullable":false}],"plainFields":[{"name":"failed_login_attempts","type":"int","description":"Count of consecutive failed login attempts. Used for rate limiting and account locking after 5 failed attempts within 15 minutes per requirements.","nullable":false},{"name":"last_failed_login_at","type":"datetime","description":"Timestamp of most recent failed login attempt. Used to calculate rate limiting windows and reset counters after timeout periods.","nullable":true},{"name":"account_locked_until","type":"datetime","description":"Timestamp until which account is locked due to failed login attempts. Null if not locked. Auto-unlocks after 30 minutes per requirements.","nullable":true},{"name":"last_successful_login_at","type":"datetime","description":"Timestamp of most recent successful login. Used for security monitoring, user activity tracking, and displaying last login on profile.","nullable":true},{"name":"last_login_ip","type":"string","description":"IP address from most recent login attempt. Used for security monitoring, suspicious activity detection, and geographic login patterns.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when authentication credential record was created (typically when user registered).","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when authentication credential record was last updated (login attempt, lock status change).","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_user_id"],"unique":true}],"plainIndexes":[{"fieldNames":["account_locked_until"]},{"fieldNames":["last_successful_login_at"]}],"ginIndexes":[]},{"name":"reddit_like_email_verifications","description":"Email verification tokens generated when users register or change email addresses. Manages verification workflow with unique time-limited links expiring after 24 hours per requirements. Supports both initial registration verification and email change verification workflows.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_user_id","type":"uuid","description":"User requesting email verification. {@link reddit_like_users.id}","relation":{"name":"user","targetModel":"reddit_like_users"},"unique":false,"nullable":false}],"plainFields":[{"name":"email","type":"string","description":"Email address being verified. For registration, matches user's current email. For email changes, this is the new pending email awaiting verification.","nullable":false},{"name":"verification_token","type":"string","description":"Unique cryptographically secure token included in verification link. Used to validate verification request. Generated using secure random number generation.","nullable":false},{"name":"verification_type","type":"string","description":"Type of verification: 'registration' (initial account email verification) or 'email_change' (verifying new email address). Determines workflow after verification.","nullable":false},{"name":"expires_at","type":"datetime","description":"Timestamp when verification token expires. Set to 24 hours after creation per requirements. Expired tokens cannot be used.","nullable":false},{"name":"verified_at","type":"datetime","description":"Timestamp when email was successfully verified by clicking link. Null if not yet verified. Marks verification completion.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when verification token was generated and email sent.","nullable":false}],"uniqueIndexes":[{"fieldNames":["verification_token"],"unique":true}],"plainIndexes":[{"fieldNames":["reddit_like_user_id","verified_at"]},{"fieldNames":["expires_at"]},{"fieldNames":["email"]}],"ginIndexes":[]},{"name":"reddit_like_password_resets","description":"Password reset tokens generated when users request password recovery via forgot password workflow. Manages time-limited reset links expiring after 1 hour per requirements. Tracks token usage to prevent reuse and supports the complete password reset workflow including expiration and retry mechanisms.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_user_id","type":"uuid","description":"User requesting password reset. {@link reddit_like_users.id}","relation":{"name":"user","targetModel":"reddit_like_users"},"unique":false,"nullable":false}],"plainFields":[{"name":"email","type":"string","description":"Email address for which password reset was requested. Used to send reset link and validate reset request matches account email.","nullable":false},{"name":"reset_token","type":"string","description":"Unique cryptographically secure token included in password reset link. Used to validate reset request. Generated using secure random number generation.","nullable":false},{"name":"expires_at","type":"datetime","description":"Timestamp when reset token expires. Set to 1 hour after creation per requirements. Expired tokens cannot be used for password reset.","nullable":false},{"name":"used_at","type":"datetime","description":"Timestamp when password was successfully reset using this token. Null if not yet used. Prevents token reuse - tokens can only be used once.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when password reset token was generated and email sent.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reset_token"],"unique":true}],"plainIndexes":[{"fieldNames":["reddit_like_user_id","used_at"]},{"fieldNames":["expires_at"]},{"fieldNames":["email"]}],"ginIndexes":[]},{"name":"reddit_like_sessions","description":"User sessions managing authentication state using JWT tokens. Each session contains access token (expires in 30 minutes) and refresh token (expires in 30 days) per requirements. Tracks active user authentication, enables token refresh without re-login, and monitors session activity for security. Sessions can be explicitly revoked on logout or invalidated on password changes.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_user_id","type":"uuid","description":"User who owns this session. {@link reddit_like_users.id}","relation":{"name":"user","targetModel":"reddit_like_users"},"unique":false,"nullable":false}],"plainFields":[{"name":"access_token","type":"string","description":"JWT access token used for authenticating API requests. Expires in 30 minutes per requirements. Contains user ID, username, and role in payload.","nullable":false},{"name":"refresh_token","type":"string","description":"JWT refresh token used to obtain new access tokens without re-login. Expires in 30 days per requirements. Longer-lived than access token.","nullable":false},{"name":"access_token_expires_at","type":"datetime","description":"Timestamp when access token expires. Set to 30 minutes from token issue time per requirements. After expiration, token cannot authenticate requests.","nullable":false},{"name":"refresh_token_expires_at","type":"datetime","description":"Timestamp when refresh token expires. Set to 30 days from token issue time per requirements. After expiration, user must re-login with credentials.","nullable":false},{"name":"ip_address","type":"string","description":"IP address from which session was created. Used for security monitoring, suspicious activity detection, and geographic login analysis.","nullable":true},{"name":"user_agent","type":"string","description":"Browser user agent string for session. Used for device tracking, security monitoring, and identifying unusual login patterns.","nullable":true},{"name":"last_activity_at","type":"datetime","description":"Timestamp of most recent activity in this session. Updated on each authenticated request. Used for session timeout and activity monitoring.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when session was created (user logged in). Used for session duration tracking.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when session was last updated (activity timestamp change).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp when session was explicitly revoked (user logged out or password changed). Null for active sessions. Follows platform soft-delete pattern.","nullable":true}],"uniqueIndexes":[{"fieldNames":["access_token"],"unique":true},{"fieldNames":["refresh_token"],"unique":true}],"plainIndexes":[{"fieldNames":["reddit_like_user_id","deleted_at"]},{"fieldNames":["access_token_expires_at"]},{"fieldNames":["refresh_token_expires_at"]},{"fieldNames":["last_activity_at"]}],"ginIndexes":[]},{"name":"reddit_like_users","description":"Unified user table representing all user types on the platform. Uses role-based access control with a single user entity supporting the four-tier hierarchy (guest, member, moderator, admin). This design ensures global username/email uniqueness, proper normalization, and simplified authentication. Users have profile information, karma scores, and privacy settings. Moderator and admin roles are granted through the role field, with community-specific moderator assignments tracked in reddit_like_community_moderators junction table.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"username","type":"string","description":"Unique username chosen during registration. Must be 3-20 characters containing only alphanumeric characters, underscores, and hyphens. Displayed throughout the platform as the user's identity. Globally unique across all user roles.","nullable":false},{"name":"email","type":"string","description":"Unique email address for authentication and communication. Used for login, verification, and notifications. Globally unique across all user roles.","nullable":false},{"name":"password_hash","type":"string","description":"Securely hashed password using bcrypt, Argon2, or PBKDF2. Never stored in plain text. Used for authentication. Null for guest users who haven't registered.","nullable":true},{"name":"role","type":"string","description":"User role determining permission level. Valid values: 'guest' (unauthenticated visitor), 'member' (standard user), 'moderator' (community manager), 'admin' (platform manager). Role can be elevated as users gain privileges.","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the user has verified their email address. Some features require verified email status. Always false for guest users.","nullable":false},{"name":"profile_bio","type":"string","description":"Optional user biography or description displayed on their profile page. Limited to 200-500 characters per requirements.","nullable":true},{"name":"avatar_url","type":"uri","description":"URL to the user's profile avatar image. Points to uploaded custom avatar or platform-generated default avatar based on username.","nullable":true},{"name":"post_karma","type":"int","description":"Denormalized karma earned from votes on user's posts. Calculated as sum of (upvotes - downvotes) across all posts. Can be negative. Updated in real-time from voting activity. Default 0 for new users.","nullable":false},{"name":"comment_karma","type":"int","description":"Denormalized karma earned from votes on user's comments. Calculated as sum of (upvotes - downvotes) across all comments. Can be negative. Updated in real-time from voting activity. Default 0 for new users.","nullable":false},{"name":"show_karma_publicly","type":"boolean","description":"Privacy setting controlling whether karma scores are visible on public profile. Per requirements, users can hide karma from display. Default true (karma visible).","nullable":false},{"name":"profile_privacy","type":"string","description":"Profile visibility level per privacy requirements. Valid values: 'public' (visible to all including guests), 'members_only' (authenticated users only), 'private' (only self). Default 'public'.","nullable":false},{"name":"show_subscriptions_publicly","type":"boolean","description":"Privacy setting for community subscription list visibility. Per requirements, users control subscription list privacy independently of overall profile privacy. Default true (subscriptions visible).","nullable":false},{"name":"is_super_admin","type":"boolean","description":"Whether this admin user has super admin privileges for critical platform operations like managing other administrators. Only applicable when role is 'admin'. Default false.","nullable":false},{"name":"session_identifier","type":"string","description":"For guest users, tracks anonymous session for analytics. Null for authenticated users. Used for guest conversion tracking and analytics.","nullable":true},{"name":"ip_address","type":"string","description":"For guest users, stores IP address for security monitoring and rate limiting. Null for authenticated users where IP is tracked in sessions table.","nullable":true},{"name":"user_agent","type":"string","description":"For guest users, browser user agent string for device analytics. Null for authenticated users where user agent is tracked in sessions table.","nullable":true},{"name":"first_visit_at","type":"datetime","description":"For guest users, timestamp of first platform visit. Null for authenticated users. Used for guest conversion analysis.","nullable":true},{"name":"last_visit_at","type":"datetime","description":"For guest users, timestamp of most recent visit. Null for authenticated users. Used for guest engagement tracking.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when user account was created. For guests, when session started. For members/moderators/admins, when they registered. Displayed as account age on profiles.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when user account was last updated. Tracks profile changes, role elevations, and setting modifications.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. When set, account is deactivated but data preserved for recovery and referential integrity. Null indicates active account.","nullable":true}],"uniqueIndexes":[{"fieldNames":["username"],"unique":true},{"fieldNames":["email"],"unique":true},{"fieldNames":["session_identifier"],"unique":true}],"plainIndexes":[{"fieldNames":["role","created_at"]},{"fieldNames":["email_verified"]},{"fieldNames":["post_karma","comment_karma"]},{"fieldNames":["last_visit_at"]}],"ginIndexes":[]}]},{"filename":"schema-03-communities.prisma","namespace":"Communities","models":[{"name":"reddit_like_communities","description":"Core community entity representing a subreddit-like community where users gather around shared interests. Communities serve as the organizational structure for all content, with each community having its own rules, moderators, and subscriber base. Communities can be public (visible to all) or private (invitation/approval required).","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creator_id","type":"uuid","description":"User who created this community and serves as the primary moderator. References {@link reddit_like_members.id}.","relation":{"name":"creator","targetModel":"reddit_like_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"code","type":"string","description":"Unique community identifier used in URLs (3-25 characters, alphanumeric and underscores only, case-insensitive). Examples: technology, gaming, science.","nullable":false},{"name":"name","type":"string","description":"Display name of the community (3-25 characters). This is shown in the UI and can differ from the code.","nullable":false},{"name":"description","type":"string","description":"Community description explaining its purpose and topic (10-500 characters). Helps users understand what the community is about.","nullable":false},{"name":"icon_url","type":"uri","description":"URL to the community icon image (256x256 pixels). Uploaded by moderators for community branding.","nullable":true},{"name":"banner_url","type":"uri","description":"URL to the community banner image (max width 1920px). Uploaded by moderators for community header.","nullable":true},{"name":"privacy_type","type":"string","description":"Privacy setting for the community. Values: public (anyone can view), private (approval required to view). Default is public.","nullable":false},{"name":"posting_permission","type":"string","description":"Who can create posts in this community. Values: anyone_subscribed, approved_only, moderators_only. Default is anyone_subscribed.","nullable":false},{"name":"allow_text_posts","type":"boolean","description":"Whether text posts are allowed in this community. Moderators can disable specific post types.","nullable":false},{"name":"allow_link_posts","type":"boolean","description":"Whether link posts are allowed in this community. Moderators can disable specific post types.","nullable":false},{"name":"allow_image_posts","type":"boolean","description":"Whether image posts are allowed in this community. Moderators can disable specific post types.","nullable":false},{"name":"primary_category","type":"string","description":"Main category for community classification (Technology, Gaming, Sports, Entertainment, Education, Science, Arts, News, Lifestyle, Business, Other). Used for discovery and browsing.","nullable":false},{"name":"secondary_tags","type":"string","description":"Additional tags for better discoverability (up to 3 tags, comma-separated). Helps users find communities through search and recommendations.","nullable":true},{"name":"subscriber_count","type":"int","description":"Total number of subscribers to this community. Denormalized for performance, updated when subscriptions change.","nullable":false},{"name":"is_archived","type":"boolean","description":"Whether this community is archived due to inactivity. Archived communities prevent new posts but remain viewable.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the community was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the community settings were last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp when the community was soft-deleted. Null if active. Deleted communities enter 30-day cooldown before permanent deletion.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["subscriber_count"]},{"fieldNames":["primary_category"]},{"fieldNames":["privacy_type","is_archived"]}],"ginIndexes":[{"fieldName":"name"},{"fieldName":"description"}]},{"name":"reddit_like_community_rules","description":"Community-specific rules defined by moderators (maximum 15 rules per community). Rules help maintain community standards and guide user behavior. Each rule has a title and optional detailed description.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"community_id","type":"uuid","description":"Community that this rule belongs to. References {@link reddit_like_communities.id}.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","description":"Rule title (3-100 characters). Short, clear statement of the rule. Examples: No self-promotion, Be respectful, Posts must be related to topic.","nullable":false},{"name":"description","type":"string","description":"Optional detailed explanation of the rule (0-500 characters). Provides additional context and examples for the rule.","nullable":true},{"name":"rule_type","type":"string","description":"Type of rule for categorization. Values: required (must do), prohibited (must not do), etiquette (recommended behavior).","nullable":false},{"name":"display_order","type":"int","description":"Order in which this rule should be displayed (1-15). Lower numbers appear first. Used for sorting rules in the UI.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the rule was created by moderators.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the rule was last modified by moderators.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["community_id","display_order"]}],"ginIndexes":[]},{"name":"reddit_like_community_subscriptions","description":"Many-to-many junction table tracking which users are subscribed to which communities. Subscriptions determine what content appears in a user's personalized feed. Users can subscribe to unlimited communities.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"community_id","type":"uuid","description":"Community that the user subscribed to. References {@link reddit_like_communities.id}.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false},{"name":"member_id","type":"uuid","description":"User who subscribed to the community. References {@link reddit_like_members.id}.","relation":{"name":"member","targetModel":"reddit_like_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"subscribed_at","type":"datetime","description":"Timestamp when the user subscribed to the community. Used for tracking subscription history and feed ordering.","nullable":false}],"uniqueIndexes":[{"fieldNames":["community_id","member_id"],"unique":true}],"plainIndexes":[{"fieldNames":["member_id"]},{"fieldNames":["subscribed_at"]}],"ginIndexes":[]},{"name":"reddit_like_community_moderators","description":"Many-to-many junction table tracking moderator assignments to communities. Moderators manage content, enforce rules, and configure community settings. Each moderator can have different permission levels, and the primary moderator (creator) has irrevocable permissions.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"community_id","type":"uuid","description":"Community that this moderator manages. References {@link reddit_like_communities.id}.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false},{"name":"moderator_id","type":"uuid","description":"Moderator user assigned to this community. References {@link reddit_like_moderators.id}.","relation":{"name":"moderator","targetModel":"reddit_like_moderators","mappingName":"reddit_like_community_moderators_of_moderator_id"},"unique":false,"nullable":false},{"name":"assigned_by_moderator_id","type":"uuid","description":"Moderator who assigned this moderator to the community. Null for the primary moderator (community creator). References {@link reddit_like_moderators.id}.","relation":{"name":"assignedBy","targetModel":"reddit_like_moderators","mappingName":"reddit_like_community_moderators_of_assigned_by_moderator_id"},"unique":false,"nullable":true}],"plainFields":[{"name":"assigned_at","type":"datetime","description":"Timestamp when this moderator was assigned to the community. Used for seniority-based permissions.","nullable":false},{"name":"is_primary","type":"boolean","description":"Whether this is the primary moderator (community creator). Primary moderators have irrevocable permissions and can remove any other moderator.","nullable":false},{"name":"permissions","type":"string","description":"JSON or comma-separated list of granted permissions. Possible values: manage_posts, manage_comments, manage_users, manage_settings, manage_moderators, access_reports. Primary moderators have all permissions.","nullable":false}],"uniqueIndexes":[{"fieldNames":["community_id","moderator_id"],"unique":true}],"plainIndexes":[{"fieldNames":["moderator_id"]},{"fieldNames":["assigned_at"]}],"ginIndexes":[]}]},{"filename":"schema-04-posts.prisma","namespace":"Posts","models":[{"name":"reddit_like_posts","description":"Main posts table storing common attributes for all post types (text, link, image). Posts are the primary content type in the platform, created by members within communities. Each post has a type discriminator and links to type-specific content tables. Posts support voting, commenting, editing, and soft deletion. Vote scores and comment counts should be calculated from related tables or materialized views, not stored here to maintain strict 3NF normalization.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_member_id","type":"uuid","description":"Post author's {@link reddit_like_members.id}. References the member who created this post.","relation":{"name":"author","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"reddit_like_community_id","type":"uuid","description":"Community where post was published {@link reddit_like_communities.id}. Every post belongs to exactly one community.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false}],"plainFields":[{"name":"type","type":"string","description":"Post type discriminator. Valid values: 'text', 'link', 'image'. Determines which type-specific content table contains the post's detailed content.","nullable":false},{"name":"title","type":"string","description":"Post title (3-300 characters). Required for all post types. Indexed for full-text search.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the post was created. Used for chronological sorting and time-based filtering.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last edit. Updated when post title or type-specific content is modified. Initially equals created_at.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp. When set, post is hidden from public view but preserved in database with metadata. Null indicates post is active.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["reddit_like_community_id","created_at"]},{"fieldNames":["reddit_like_member_id","created_at"]},{"fieldNames":["type","created_at"]}],"ginIndexes":[{"fieldName":"title"}]},{"name":"reddit_like_post_text_content","description":"Text-specific content for text posts. Contains the body text/markdown content for posts with type='text'. Has 1:1 relationship with reddit_like_posts. The body supports markdown formatting and can be up to 40,000 characters. Managed through parent post entity - no independent lifecycle.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_post_id","type":"uuid","description":"Parent post's {@link reddit_like_posts.id}. One-to-one relationship with posts table.","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":true,"nullable":false}],"plainFields":[{"name":"body","type":"string","description":"Post body text content. Supports markdown formatting. Maximum 40,000 characters. Can be empty for title-only posts. Indexed for full-text search.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when text content was created. Typically matches parent post's created_at.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when text content was last edited. Updated when body is modified within edit time window.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_post_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"body"}]},{"name":"reddit_like_post_link_content","description":"Link-specific content for link posts. Contains URL and extracted metadata for posts with type='link'. Has 1:1 relationship with reddit_like_posts. The system attempts to extract Open Graph metadata (title, description, preview image) from the target URL. Managed through parent post entity - no independent lifecycle.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_post_id","type":"uuid","description":"Parent post's {@link reddit_like_posts.id}. One-to-one relationship with posts table.","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":true,"nullable":false}],"plainFields":[{"name":"url","type":"string","description":"The shared URL (HTTP or HTTPS). Maximum 2,000 characters. Required for all link posts. Must be valid web address.","nullable":false},{"name":"domain","type":"string","description":"Extracted domain name from URL for display and filtering. Example: 'example.com' from 'https://example.com/article'. Indexed for domain-based queries.","nullable":false},{"name":"preview_title","type":"string","description":"Extracted page title from target URL metadata (Open Graph or meta tags). Used for preview display. Null if extraction failed or not yet attempted.","nullable":true},{"name":"preview_description","type":"string","description":"Extracted page description from target URL metadata. Used for preview display. Null if extraction failed or not yet attempted.","nullable":true},{"name":"preview_image_url","type":"string","description":"Extracted preview/thumbnail image URL from target page metadata. Used for link preview card. Null if no image available or extraction failed.","nullable":true},{"name":"metadata_fetched_at","type":"datetime","description":"Timestamp when metadata extraction was attempted. Null if metadata hasn't been fetched yet. Used to determine if re-fetch is needed.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when link content was created. Typically matches parent post's created_at.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when link content was last updated. Updated when metadata is refreshed.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_post_id"],"unique":true}],"plainIndexes":[{"fieldNames":["domain"]}],"ginIndexes":[]},{"name":"reddit_like_post_image_content","description":"Image-specific content for image posts. Contains image URLs and metadata for posts with type='image'. Has 1:1 relationship with reddit_like_posts. The system stores multiple image versions (original, medium 640px, thumbnail 150x150) for responsive display. Includes optional caption supporting markdown. Managed through parent post entity - no independent lifecycle.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_post_id","type":"uuid","description":"Parent post's {@link reddit_like_posts.id}. One-to-one relationship with posts table.","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":true,"nullable":false}],"plainFields":[{"name":"original_image_url","type":"string","description":"URL to full-resolution original uploaded image. Used for full-size viewing. Maximum 20MB file size.","nullable":false},{"name":"medium_image_url","type":"string","description":"URL to medium-resolution version (640px width). Used for feed display. Maintains aspect ratio.","nullable":false},{"name":"thumbnail_image_url","type":"string","description":"URL to thumbnail version (150x150 pixels). Used for list views and previews. Maintains aspect ratio within bounds.","nullable":false},{"name":"image_width","type":"int","description":"Original image width in pixels. Used for aspect ratio calculations and responsive display.","nullable":false},{"name":"image_height","type":"int","description":"Original image height in pixels. Used for aspect ratio calculations and responsive display.","nullable":false},{"name":"file_size","type":"int","description":"Original image file size in bytes. Maximum 20MB (20,971,520 bytes). Displayed to users.","nullable":false},{"name":"file_format","type":"string","description":"Image file format. Valid values: 'JPEG', 'PNG', 'GIF', 'WebP'. Validated during upload.","nullable":false},{"name":"caption","type":"string","description":"Optional image caption (up to 10,000 characters). Supports markdown formatting. Displayed below image. Indexed for search.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when image content was created. Typically matches parent post's created_at.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when image content was last updated. Updated when caption is modified.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_post_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"caption"}]},{"name":"mv_reddit_like_post_metrics","description":"Materialized view for post engagement metrics providing denormalized vote scores and comment counts for query performance optimization. Pre-calculates net vote score (upvotes - downvotes) from reddit_like_post_votes and total comment count from reddit_like_comments. Refreshed periodically to maintain accurate metrics without impacting write performance on normalized tables. This is the ONLY appropriate location for denormalized post metrics per architectural requirements.","material":true,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_post_id","type":"uuid","description":"Reference to the post whose metrics are calculated. {@link reddit_like_posts.id}","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":true,"nullable":false}],"plainFields":[{"name":"vote_score","type":"int","description":"Pre-calculated net vote score (upvotes minus downvotes) aggregated from reddit_like_post_votes. This denormalized value enables fast query performance for sorting and ranking algorithms without real-time vote aggregation.","nullable":false},{"name":"comment_count","type":"int","description":"Pre-calculated total number of comments on this post aggregated from reddit_like_comments. This denormalized value enables fast feed display and post listing without counting comments in real-time.","nullable":false},{"name":"upvote_count","type":"int","description":"Total number of upvotes (vote_value = 1) aggregated from reddit_like_post_votes. Used for calculating upvote percentage and controversial ranking.","nullable":false},{"name":"downvote_count","type":"int","description":"Total number of downvotes (vote_value = -1) aggregated from reddit_like_post_votes. Used for calculating upvote percentage and controversial ranking.","nullable":false},{"name":"last_calculated_at","type":"datetime","description":"Timestamp when this materialized view was last refreshed with current vote and comment data. Indicates the freshness of calculated metrics.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_post_id"],"unique":true}],"plainIndexes":[{"fieldNames":["vote_score"]},{"fieldNames":["comment_count"]}],"ginIndexes":[]}]},{"filename":"schema-05-comments.prisma","namespace":"Comments","models":[{"name":"reddit_like_comments","description":"Comment system supporting nested threaded discussions on posts. Comments can be replies to other comments (nested up to 10 levels deep) or top-level comments. Each comment belongs to a post and has an author. Comments track vote scores, edit status, and support soft deletion to preserve thread structure. The parent-child relationship enables threaded conversations while maintaining clean data structure.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_post_id","type":"uuid","description":"Post where this comment was created. {@link reddit_like_posts.id}","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":false,"nullable":false},{"name":"reddit_like_parent_comment_id","type":"uuid","description":"Parent comment for nested threading. Null for top-level comments. {@link reddit_like_comments.id}","relation":{"name":"parentComment","targetModel":"reddit_like_comments","mappingName":"recursive"},"unique":false,"nullable":true},{"name":"reddit_like_member_id","type":"uuid","description":"Author of this comment. {@link reddit_like_members.id}","relation":{"name":"author","targetModel":"reddit_like_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"content_text","type":"string","description":"Text content of the comment. Supports markdown formatting and up to 10,000 characters.","nullable":false},{"name":"depth","type":"int","description":"Nesting level in comment tree. 0 for top-level comments, increments for each reply level. Maximum depth of 10 enforced at application level.","nullable":false},{"name":"vote_score","type":"int","description":"Net vote score calculated as upvotes minus downvotes. Updated when votes are cast via reddit_like_comment_votes table.","nullable":false},{"name":"edited","type":"boolean","description":"Whether this comment has been edited after initial creation. Set to true when content_text is modified.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when comment was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when comment was last modified (edit or vote update).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. When set, comment content is hidden but thread structure is preserved. Null for active comments.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["reddit_like_post_id","created_at"]},{"fieldNames":["reddit_like_member_id","created_at"]},{"fieldNames":["reddit_like_parent_comment_id"]},{"fieldNames":["created_at"]},{"fieldNames":["vote_score","created_at"]}],"ginIndexes":[{"fieldName":"content_text"}]}]},{"filename":"schema-06-voting.prisma","namespace":"Voting","models":[{"name":"reddit_like_post_votes","description":"Individual user votes on posts enabling democratic content curation through upvotes and downvotes. Each record represents a single user's vote on a specific post, storing the vote direction (upvote +1 or downvote -1), timestamp, and anti-manipulation data. This table is the foundation for calculating post karma, vote scores, and detecting voting patterns for anti-manipulation measures. Users can change their votes, with updated_at tracking modifications. The unique constraint on (member, post) ensures one vote per user per post. IP address and user agent tracking enable detection of multiple accounts and vote manipulation per requirements section 8.3. Vote weight field supports trust-based vote impact adjustments per requirements section 8.6.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_member_id","type":"uuid","description":"The member who cast this vote. {@link reddit_like_members.id}","relation":{"name":"voter","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"reddit_like_post_id","type":"uuid","description":"The post being voted on. {@link reddit_like_posts.id}","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":false,"nullable":false}],"plainFields":[{"name":"vote_value","type":"int","description":"The vote direction: 1 for upvote (positive endorsement), -1 for downvote (negative signal). This value directly impacts the post's net vote score and the post author's karma.","nullable":false},{"name":"ip_address","type":"string","description":"IP address of the voter at time of vote. Required per requirements section 8.3 for detecting multiple accounts from same IP voting on same content, implementing vote weight reduction for suspicious IPs, and identifying vote brigading patterns. Used for anti-manipulation analysis and security monitoring.","nullable":true},{"name":"user_agent","type":"string","description":"Browser user agent string of the voter's device. Required per requirements section 8.3 for device fingerprinting to detect users operating multiple accounts. Enables correlation of voting patterns across devices for sockpuppet detection.","nullable":true},{"name":"vote_weight","type":"double","description":"Calculated weight for this vote based on trust factors per requirements section 8.6. Default value 1.0 for normal votes. Reduced values (0.5, 0.25) for new accounts, suspicious patterns, or low-trust voters. May be increased (rare) for highly trusted accounts. Used to calculate weighted vote impact on scores and karma. Enables trust-based vote weighting without deleting votes.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the vote was originally cast. Used for vote velocity calculations, manipulation detection, engagement analytics, and hot algorithm time decay factors.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the vote was last modified (vote value changed or weight adjusted). Tracks vote changes for detecting rapid vote cycling manipulation and vote editing patterns. Initially equals created_at.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_member_id","reddit_like_post_id"],"unique":true}],"plainIndexes":[{"fieldNames":["reddit_like_post_id","vote_value"]},{"fieldNames":["reddit_like_member_id","created_at"]},{"fieldNames":["created_at"]},{"fieldNames":["reddit_like_post_id","created_at"]},{"fieldNames":["reddit_like_member_id","vote_value","created_at"]},{"fieldNames":["ip_address","created_at"]}],"ginIndexes":[]},{"name":"reddit_like_comment_votes","description":"Individual user votes on comments enabling community-driven discussion quality assessment through upvotes and downvotes. Each record represents a single user's vote on a specific comment, storing the vote direction (upvote +1 or downvote -1), timestamp, and anti-manipulation data. This table powers comment karma calculation, comment sorting algorithms (best, top, controversial), and vote manipulation detection. Users can modify their votes, with updated_at tracking changes. The unique constraint on (member, comment) enforces one vote per user per comment. IP address and user agent tracking enable detection of coordinated voting and multiple account abuse per requirements section 8.3. Vote weight field supports trust-based vote impact adjustments per requirements section 8.6.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_member_id","type":"uuid","description":"The member who cast this vote. {@link reddit_like_members.id}","relation":{"name":"voter","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"reddit_like_comment_id","type":"uuid","description":"The comment being voted on. {@link reddit_like_comments.id}","relation":{"name":"comment","targetModel":"reddit_like_comments"},"unique":false,"nullable":false}],"plainFields":[{"name":"vote_value","type":"int","description":"The vote direction: 1 for upvote (positive endorsement), -1 for downvote (negative signal). This value directly impacts the comment's net vote score and the comment author's karma.","nullable":false},{"name":"ip_address","type":"string","description":"IP address of the voter at time of vote. Required per requirements section 8.3 for detecting multiple accounts from same IP voting on same content, implementing vote weight reduction for suspicious IPs, and identifying coordinated comment vote brigading. Used for anti-manipulation analysis and security monitoring.","nullable":true},{"name":"user_agent","type":"string","description":"Browser user agent string of the voter's device. Required per requirements section 8.3 for device fingerprinting to detect users operating multiple accounts for comment vote manipulation. Enables correlation of voting patterns across devices for sockpuppet detection.","nullable":true},{"name":"vote_weight","type":"double","description":"Calculated weight for this vote based on trust factors per requirements section 8.6. Default value 1.0 for normal votes. Reduced values (0.5, 0.25) for new accounts, suspicious patterns, or low-trust voters. May be increased (rare) for highly trusted accounts. Used to calculate weighted vote impact on comment scores and karma. Enables trust-based vote weighting without deleting votes.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the vote was originally cast. Used for vote timing analysis, manipulation detection patterns (rapid voting, coordinated timing), engagement metrics, and comment sorting algorithm inputs.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the vote was last modified (vote value changed or weight adjusted). Tracks vote changes for detecting rapid vote cycling manipulation and vote editing patterns. Initially equals created_at.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_member_id","reddit_like_comment_id"],"unique":true}],"plainIndexes":[{"fieldNames":["reddit_like_comment_id","vote_value"]},{"fieldNames":["reddit_like_member_id","created_at"]},{"fieldNames":["created_at"]},{"fieldNames":["reddit_like_comment_id","created_at"]},{"fieldNames":["reddit_like_member_id","vote_value","created_at"]},{"fieldNames":["ip_address","created_at"]}],"ginIndexes":[]}]},{"filename":"schema-07-karma.prisma","namespace":"Karma","models":[{"name":"reddit_like_user_karma","description":"Stores current karma scores for each user, tracking post karma and comment karma separately. Karma represents user reputation earned through community voting on their content. This table maintains the current state of each user's karma totals, which are updated in real-time as votes are cast on their posts and comments. Per business requirements, karma persists even when content is deleted, and can be negative without limit.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_member_id","type":"uuid","description":"Reference to the user who owns this karma record. {@link reddit_like_members.id}","relation":{"name":"member","targetModel":"reddit_like_members"},"unique":true,"nullable":false}],"plainFields":[{"name":"post_karma","type":"int","description":"Karma earned from votes on the user's posts. Calculated as sum of (upvotes - downvotes) across all posts created by this user. Can be negative if user's posts receive more downvotes than upvotes. Updated in real-time as votes are cast.","nullable":false},{"name":"comment_karma","type":"int","description":"Karma earned from votes on the user's comments. Calculated as sum of (upvotes - downvotes) across all comments created by this user. Can be negative if user's comments receive more downvotes than upvotes. Updated in real-time as votes are cast.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when this karma record was created (when user account was initialized).","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when karma scores were last modified. Updated whenever post_karma or comment_karma changes due to voting activity.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_member_id"],"unique":true}],"plainIndexes":[{"fieldNames":["post_karma","comment_karma"]}],"ginIndexes":[]},{"name":"reddit_like_karma_history","description":"Audit trail tracking all karma changes over time. Each record represents a single karma modification event triggered by voting activity on user content. This history enables transparency, troubleshooting karma calculation issues, and provides users insight into how their reputation evolved. Records are retained for minimum 12 months per business requirements.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_member_id","type":"uuid","description":"Reference to the user whose karma changed. {@link reddit_like_members.id}","relation":{"name":"member","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"reddit_like_post_id","type":"uuid","description":"Reference to the post that triggered this karma change (if applicable). Null if karma change was from comment voting. {@link reddit_like_posts.id}","relation":{"name":"post","targetModel":"reddit_like_posts"},"unique":false,"nullable":true},{"name":"reddit_like_comment_id","type":"uuid","description":"Reference to the comment that triggered this karma change (if applicable). Null if karma change was from post voting. {@link reddit_like_comments.id}","relation":{"name":"comment","targetModel":"reddit_like_comments"},"unique":false,"nullable":true}],"plainFields":[{"name":"karma_type","type":"string","description":"Type of karma that changed. Valid values: 'post' (change to post karma) or 'comment' (change to comment karma). Indicates which karma counter was affected by this event.","nullable":false},{"name":"change_amount","type":"int","description":"Amount of karma change. Positive values (+1, +2) indicate karma increases from upvotes. Negative values (-1, -2) indicate karma decreases from downvotes or vote changes. Common values: +1 (upvote added), -1 (downvote added or upvote removed), +2 (vote changed from downvote to upvote), -2 (vote changed from upvote to downvote).","nullable":false},{"name":"triggered_by_vote_action","type":"string","description":"Vote action that triggered this karma change. Valid values: 'upvote_added', 'downvote_added', 'vote_removed', 'vote_changed_to_upvote', 'vote_changed_to_downvote'. Provides context for why karma changed.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when this karma change occurred. Matches the timestamp of the vote action that triggered the change.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["reddit_like_member_id","created_at"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"mv_reddit_like_karma_calculations","description":"Materialized view for efficient karma calculation verification. Pre-calculates karma totals by aggregating votes from reddit_like_post_votes and reddit_like_comment_votes. Used to verify karma accuracy, detect discrepancies, and provide fast karma lookups without real-time vote aggregation. This is a denormalized performance optimization table refreshed periodically. Marked as @hidden in documentation per materialized view conventions.","material":true,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reddit_like_member_id","type":"uuid","description":"Reference to the user whose karma is calculated. {@link reddit_like_members.id}","relation":{"name":"member","targetModel":"reddit_like_members"},"unique":true,"nullable":false}],"plainFields":[{"name":"calculated_post_karma","type":"int","description":"Calculated post karma by summing (upvotes - downvotes) across all posts created by this user. This is a pre-computed aggregate value refreshed periodically. Used for karma verification and discrepancy detection.","nullable":false},{"name":"calculated_comment_karma","type":"int","description":"Calculated comment karma by summing (upvotes - downvotes) across all comments created by this user. This is a pre-computed aggregate value refreshed periodically. Used for karma verification and discrepancy detection.","nullable":false},{"name":"last_calculated_at","type":"datetime","description":"Timestamp when this materialized view was last refreshed with current vote data. Indicates the freshness of calculated karma values.","nullable":false}],"uniqueIndexes":[{"fieldNames":["reddit_like_member_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[]}]},{"filename":"schema-08-moderation.prisma","namespace":"Moderation","models":[{"name":"reddit_like_content_reports","description":"User-submitted reports for content that may violate community or platform rules. Supports both authenticated member reports and anonymous guest reports. Each report includes violation categories, additional context, and routing information for moderator review queues. Reports are permanent records and maintain reporter privacy while enabling moderation workflows. Ensures exactly one content type is reported per submission through application-level validation.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reporter_member_id","type":"uuid","description":"Reporter's member account. {@link reddit_like_members.id}. Nullable for anonymous guest reports.","relation":{"name":"reporter","targetModel":"reddit_like_members"},"unique":false,"nullable":true},{"name":"reported_post_id","type":"uuid","description":"Reported post if content type is post. {@link reddit_like_posts.id}. Nullable when reporting comments. Must be non-null when content_type='post'.","relation":{"name":"reportedPost","targetModel":"reddit_like_posts"},"unique":false,"nullable":true},{"name":"reported_comment_id","type":"uuid","description":"Reported comment if content type is comment. {@link reddit_like_comments.id}. Nullable when reporting posts. Must be non-null when content_type='comment'.","relation":{"name":"reportedComment","targetModel":"reddit_like_comments"},"unique":false,"nullable":true},{"name":"community_id","type":"uuid","description":"Community where reported content exists, used for routing to correct moderators. {@link reddit_like_communities.id}.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false}],"plainFields":[{"name":"content_type","type":"string","description":"Type of content being reported: 'post' or 'comment'. Used for polymorphic relationship handling and validation.","nullable":false},{"name":"violation_categories","type":"string","description":"Comma-separated or JSON array of violation category names selected by reporter (spam, harassment, hate speech, etc.). Supports multiple categories per report.","nullable":false},{"name":"additional_context","type":"string","description":"Optional text provided by reporter explaining the violation (max 500 characters). Helps moderators understand reporter's perspective.","nullable":true},{"name":"status","type":"string","description":"Report review status: 'pending', 'reviewed', or 'dismissed'. Tracks progression through moderation queue.","nullable":false},{"name":"reporter_ip_address","type":"string","description":"IP address of reporter for abuse detection and anti-spam. Stored for guest reports and logged for authenticated reports.","nullable":true},{"name":"is_anonymous_report","type":"boolean","description":"Whether this report was submitted by an unauthenticated guest user. True when reporter_member_id is null, false when authenticated member submitted the report. Simplifies guest vs member report filtering.","nullable":false},{"name":"is_high_priority","type":"boolean","description":"Whether report is flagged as high priority (5+ reports on same content within 24 hours). Auto-calculated flag.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when report was submitted. Used for queue ordering and SLA tracking.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when report status was last updated (reviewed, dismissed).","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["status","created_at"]},{"fieldNames":["community_id","status"]},{"fieldNames":["content_type","status"]},{"fieldNames":["reported_post_id"]},{"fieldNames":["reported_comment_id"]},{"fieldNames":["reporter_member_id","created_at"]},{"fieldNames":["is_high_priority","status","created_at"]}],"ginIndexes":[{"fieldName":"violation_categories"}]},{"name":"reddit_like_moderation_actions","description":"Actions taken by moderators or administrators in response to content reports or proactive moderation. Records removal, approval, dismissal, and escalation decisions with full audit trail. Each action references the triggering report and includes detailed reasoning for transparency and appeal processes. Ensures exactly one content type and one actor type per action through application-level validation.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"report_id","type":"uuid","description":"Content report that triggered this action. {@link reddit_like_content_reports.id}. Nullable for proactive moderation without reports.","relation":{"name":"report","targetModel":"reddit_like_content_reports"},"unique":false,"nullable":true},{"name":"moderator_id","type":"uuid","description":"Moderator who performed this action. {@link reddit_like_moderators.id}. Nullable when action taken by admin. Exactly one of moderator_id or admin_id must be non-null.","relation":{"name":"moderator","targetModel":"reddit_like_moderators"},"unique":false,"nullable":true},{"name":"admin_id","type":"uuid","description":"Administrator who performed this action. {@link reddit_like_admins.id}. Nullable when action taken by moderator. Exactly one of moderator_id or admin_id must be non-null.","relation":{"name":"admin","targetModel":"reddit_like_admins"},"unique":false,"nullable":true},{"name":"affected_post_id","type":"uuid","description":"Post affected by this action. {@link reddit_like_posts.id}. Nullable when action affects comments. Must be non-null when content_type='post'.","relation":{"name":"affectedPost","targetModel":"reddit_like_posts"},"unique":false,"nullable":true},{"name":"affected_comment_id","type":"uuid","description":"Comment affected by this action. {@link reddit_like_comments.id}. Nullable when action affects posts. Must be non-null when content_type='comment'.","relation":{"name":"affectedComment","targetModel":"reddit_like_comments"},"unique":false,"nullable":true},{"name":"community_id","type":"uuid","description":"Community where action was taken. {@link reddit_like_communities.id}. Used for community-specific moderation scope.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false}],"plainFields":[{"name":"action_type","type":"string","description":"Type of moderation action: 'remove', 'approve', 'dismiss_report', 'escalate', 'restore', 'lock'. Defines what action was taken.","nullable":false},{"name":"content_type","type":"string","description":"Type of affected content: 'post' or 'comment'. Used for polymorphic relationship handling and validation.","nullable":false},{"name":"removal_type","type":"string","description":"For removal actions, specifies scope: 'community', 'platform', or 'spam'. Nullable for non-removal actions.","nullable":true},{"name":"reason_category","type":"string","description":"Predefined reason category selected by moderator (rule violation, spam, harassment, etc.). Required for all actions.","nullable":false},{"name":"reason_text","type":"string","description":"Detailed explanation of why action was taken. Shown to content author in notifications. Required for transparency.","nullable":false},{"name":"internal_notes","type":"string","description":"Private notes visible only to moderators and administrators. Used for context sharing among moderation team.","nullable":true},{"name":"status","type":"string","description":"Action status: 'completed', 'reversed', 'appealed'. Tracks action lifecycle including reversals.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when moderation action was taken. Critical for audit trail and SLA tracking.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when action status changed (reversed, appealed).","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["moderator_id","created_at"]},{"fieldNames":["admin_id","created_at"]},{"fieldNames":["community_id","created_at"]},{"fieldNames":["action_type","status"]},{"fieldNames":["content_type","status"]},{"fieldNames":["affected_post_id"]},{"fieldNames":["affected_comment_id"]},{"fieldNames":["report_id"]}],"ginIndexes":[{"fieldName":"reason_text"},{"fieldName":"internal_notes"}]},{"name":"reddit_like_community_bans","description":"Community-level bans issued by community moderators preventing users from participating in specific communities. Supports both temporary and permanent bans with expiration tracking. Soft delete enabled to track ban history including lifted bans while maintaining audit trail. Active bans are enforced to prevent posting, commenting, and voting in the banned community.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"banned_member_id","type":"uuid","description":"Member who is banned from the community. {@link reddit_like_members.id}.","relation":{"name":"bannedMember","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"community_id","type":"uuid","description":"Community from which member is banned. {@link reddit_like_communities.id}.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":false},{"name":"moderator_id","type":"uuid","description":"Moderator who issued the ban. {@link reddit_like_moderators.id}.","relation":{"name":"issuingModerator","targetModel":"reddit_like_moderators"},"unique":false,"nullable":false}],"plainFields":[{"name":"ban_reason_category","type":"string","description":"Predefined ban reason: 'repeated_violations', 'harassment', 'spam', 'hate_speech', 'illegal_content', 'ban_evasion', 'other'. Required for all bans.","nullable":false},{"name":"ban_reason_text","type":"string","description":"Detailed explanation of ban reason shown to banned user. Required for transparency and appeal context.","nullable":false},{"name":"internal_notes","type":"string","description":"Private notes visible only to moderators. Used for documenting ban history and context for moderation team.","nullable":true},{"name":"is_permanent","type":"boolean","description":"Whether ban is permanent (true) or temporary (false). Determines if expiration_date is relevant.","nullable":false},{"name":"expiration_date","type":"datetime","description":"Date when temporary ban expires and user regains access. Null for permanent bans. Auto-restore triggers on expiration.","nullable":true},{"name":"is_active","type":"boolean","description":"Whether ban is currently active. False when lifted by moderators or automatically expired. Used for quick active ban checks.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when ban was issued. Used for ban history tracking and duration calculations.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when ban status changed (lifted, expired).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp when ban was lifted by moderators. Null for active bans. Enables ban history tracking.","nullable":true}],"uniqueIndexes":[{"fieldNames":["banned_member_id","community_id","is_active"],"unique":true}],"plainIndexes":[{"fieldNames":["banned_member_id","is_active"]},{"fieldNames":["community_id","is_active","expiration_date"]},{"fieldNames":["expiration_date","is_active"]},{"fieldNames":["moderator_id","created_at"]}],"ginIndexes":[]},{"name":"reddit_like_platform_suspensions","description":"Platform-wide suspensions issued by administrators preventing users from accessing the entire platform. More severe than community bans, affecting all platform activity. Supports temporary and permanent suspensions with expiration tracking and soft delete for lifted suspensions.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"suspended_member_id","type":"uuid","description":"Member who is suspended from the platform. {@link reddit_like_members.id}.","relation":{"name":"suspendedMember","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"admin_id","type":"uuid","description":"Administrator who issued the suspension. {@link reddit_like_admins.id}.","relation":{"name":"issuingAdmin","targetModel":"reddit_like_admins"},"unique":false,"nullable":false}],"plainFields":[{"name":"suspension_reason_category","type":"string","description":"Predefined suspension reason: 'repeated_violations', 'harassment', 'spam', 'hate_speech', 'illegal_content', 'ban_evasion', 'other'. Required for all suspensions.","nullable":false},{"name":"suspension_reason_text","type":"string","description":"Detailed explanation of suspension reason shown to suspended user via email. Required for transparency and appeal context.","nullable":false},{"name":"internal_notes","type":"string","description":"Private notes visible only to administrators. Used for documenting suspension history and context for admin team.","nullable":true},{"name":"is_permanent","type":"boolean","description":"Whether suspension is permanent account termination (true) or temporary (false). Determines if expiration_date is relevant.","nullable":false},{"name":"expiration_date","type":"datetime","description":"Date when temporary suspension expires and user regains access. Null for permanent suspensions. Auto-restore triggers on expiration.","nullable":true},{"name":"is_active","type":"boolean","description":"Whether suspension is currently active. False when lifted by admins or automatically expired. Used for login access checks.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when suspension was issued. Used for suspension history tracking and duration calculations.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when suspension status changed (lifted, expired).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp when suspension was lifted by administrators. Null for active suspensions. Enables suspension history tracking.","nullable":true}],"uniqueIndexes":[{"fieldNames":["suspended_member_id","is_active"],"unique":true}],"plainIndexes":[{"fieldNames":["suspended_member_id","created_at"]},{"fieldNames":["expiration_date","is_active"]},{"fieldNames":["admin_id","created_at"]},{"fieldNames":["is_active","is_permanent"]}],"ginIndexes":[]},{"name":"reddit_like_moderation_appeals","description":"User-submitted appeals challenging moderation actions, bans, or suspensions. Enables due process by allowing users to contest decisions with written reasoning. Appeals are reviewed by moderators (for community actions) or administrators (for platform actions) with status tracking through resolution. Expected resolution timestamps enable SLA monitoring and automated reminder notifications.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"appellant_member_id","type":"uuid","description":"Member who submitted the appeal. {@link reddit_like_members.id}.","relation":{"name":"appellant","targetModel":"reddit_like_members"},"unique":false,"nullable":false},{"name":"moderation_action_id","type":"uuid","description":"Moderation action being appealed. {@link reddit_like_moderation_actions.id}. Nullable when appealing bans/suspensions directly.","relation":{"name":"moderationAction","targetModel":"reddit_like_moderation_actions"},"unique":false,"nullable":true},{"name":"community_ban_id","type":"uuid","description":"Community ban being appealed. {@link reddit_like_community_bans.id}. Nullable when appealing other action types.","relation":{"name":"communityBan","targetModel":"reddit_like_community_bans"},"unique":false,"nullable":true},{"name":"platform_suspension_id","type":"uuid","description":"Platform suspension being appealed. {@link reddit_like_platform_suspensions.id}. Nullable when appealing other action types.","relation":{"name":"platformSuspension","targetModel":"reddit_like_platform_suspensions"},"unique":false,"nullable":true},{"name":"reviewer_moderator_id","type":"uuid","description":"Moderator who reviewed this appeal. {@link reddit_like_moderators.id}. Nullable when reviewed by admin or still pending.","relation":{"name":"reviewerModerator","targetModel":"reddit_like_moderators"},"unique":false,"nullable":true},{"name":"reviewer_admin_id","type":"uuid","description":"Administrator who reviewed this appeal. {@link reddit_like_admins.id}. Nullable when reviewed by moderator or still pending.","relation":{"name":"reviewerAdmin","targetModel":"reddit_like_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"appeal_type","type":"string","description":"Type of action being appealed: 'content_removal', 'community_ban', 'platform_suspension'. Determines routing to moderators vs admins.","nullable":false},{"name":"appeal_text","type":"string","description":"User's written explanation of why the action should be reversed (50-1000 characters). Required reasoning for all appeals.","nullable":false},{"name":"status","type":"string","description":"Appeal status: 'pending', 'under_review', 'upheld', 'overturned', 'reduced'. Tracks progression through review process.","nullable":false},{"name":"decision_explanation","type":"string","description":"Reviewer's written explanation of appeal decision. Required when status changes from pending to final decision. Shown to appellant.","nullable":true},{"name":"is_escalated","type":"boolean","description":"Whether appeal was escalated from moderator review to administrator review. Used for tracking escalation workflow.","nullable":false},{"name":"expected_resolution_at","type":"datetime","description":"Expected timestamp by which this appeal should be reviewed and decided. Calculated based on appeal type: community appeals (2-3 days), platform suspensions (5-7 days), escalated appeals (7-10 days). Used for SLA monitoring and automated reminder notifications per R-APP-029 and R-APP-030.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when appeal was submitted. Used for SLA tracking and queue ordering.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when appeal status changed (under review, decided).","nullable":false},{"name":"reviewed_at","type":"datetime","description":"Timestamp when appeal decision was finalized. Null for pending appeals. Used for response time metrics.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["appellant_member_id","created_at"]},{"fieldNames":["status","created_at"]},{"fieldNames":["status","expected_resolution_at"]},{"fieldNames":["reviewer_moderator_id","reviewed_at"]},{"fieldNames":["reviewer_admin_id","reviewed_at"]},{"fieldNames":["moderation_action_id"]},{"fieldNames":["community_ban_id"]},{"fieldNames":["platform_suspension_id"]},{"fieldNames":["is_escalated","status"]}],"ginIndexes":[{"fieldName":"appeal_text"}]},{"name":"reddit_like_moderation_logs","description":"Comprehensive immutable audit trail of all moderation system activities. Records every report submission, action taken, ban issued, appeal filed, and decision made with complete context. Snapshot-based table serving as permanent historical record for accountability, analytics, and legal compliance.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"actor_member_id","type":"uuid","description":"Member who performed the logged action (reporter, appellant). {@link reddit_like_members.id}. Nullable for system-generated events.","relation":{"name":"actorMember","targetModel":"reddit_like_members"},"unique":false,"nullable":true},{"name":"actor_moderator_id","type":"uuid","description":"Moderator who performed the logged action. {@link reddit_like_moderators.id}. Nullable for member/admin/system actions.","relation":{"name":"actorModerator","targetModel":"reddit_like_moderators"},"unique":false,"nullable":true},{"name":"actor_admin_id","type":"uuid","description":"Administrator who performed the logged action. {@link reddit_like_admins.id}. Nullable for member/moderator/system actions.","relation":{"name":"actorAdmin","targetModel":"reddit_like_admins"},"unique":false,"nullable":true},{"name":"related_report_id","type":"uuid","description":"Content report associated with this log entry. {@link reddit_like_content_reports.id}. Nullable for non-report events.","relation":{"name":"relatedReport","targetModel":"reddit_like_content_reports"},"unique":false,"nullable":true},{"name":"related_action_id","type":"uuid","description":"Moderation action associated with this log entry. {@link reddit_like_moderation_actions.id}. Nullable for non-action events.","relation":{"name":"relatedAction","targetModel":"reddit_like_moderation_actions"},"unique":false,"nullable":true},{"name":"related_ban_id","type":"uuid","description":"Community ban associated with this log entry. {@link reddit_like_community_bans.id}. Nullable for non-ban events.","relation":{"name":"relatedBan","targetModel":"reddit_like_community_bans"},"unique":false,"nullable":true},{"name":"related_suspension_id","type":"uuid","description":"Platform suspension associated with this log entry. {@link reddit_like_platform_suspensions.id}. Nullable for non-suspension events.","relation":{"name":"relatedSuspension","targetModel":"reddit_like_platform_suspensions"},"unique":false,"nullable":true},{"name":"related_appeal_id","type":"uuid","description":"Appeal associated with this log entry. {@link reddit_like_moderation_appeals.id}. Nullable for non-appeal events.","relation":{"name":"relatedAppeal","targetModel":"reddit_like_moderation_appeals"},"unique":false,"nullable":true},{"name":"community_id","type":"uuid","description":"Community context for this log entry. {@link reddit_like_communities.id}. Nullable for platform-level events.","relation":{"name":"community","targetModel":"reddit_like_communities"},"unique":false,"nullable":true}],"plainFields":[{"name":"log_type","type":"string","description":"Category of moderation event: 'report_submitted', 'action_taken', 'ban_issued', 'ban_lifted', 'suspension_issued', 'suspension_lifted', 'appeal_submitted', 'appeal_decided', 'report_dismissed'. Used for filtering and analytics.","nullable":false},{"name":"action_description","type":"string","description":"Human-readable description of what occurred in this log entry. Auto-generated from event data for audit trail readability.","nullable":false},{"name":"metadata","type":"string","description":"JSON object containing additional context and details specific to the log event type. Flexible storage for event-specific data.","nullable":true},{"name":"ip_address","type":"string","description":"IP address of actor who performed the logged action. Stored for security auditing and abuse detection.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when moderation event occurred. Immutable audit trail timestamp with second precision.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["log_type","created_at"]},{"fieldNames":["actor_member_id","created_at"]},{"fieldNames":["actor_moderator_id","created_at"]},{"fieldNames":["actor_admin_id","created_at"]},{"fieldNames":["community_id","created_at"]},{"fieldNames":["related_report_id"]},{"fieldNames":["related_action_id"]},{"fieldNames":["related_ban_id"]},{"fieldNames":["related_suspension_id"]},{"fieldNames":["related_appeal_id"]}],"ginIndexes":[{"fieldName":"action_description"}]},{"name":"mv_reddit_like_moderator_activity_stats","description":"Materialized view providing pre-calculated moderator activity metrics for performance optimization. Aggregates data from moderation actions, reports, bans, and appeals to provide dashboard statistics without expensive real-time aggregation. Includes total actions, response times, and activity breakdowns per moderator. Refreshed periodically for near-real-time metrics. Marked as @hidden per materialized view conventions.","material":true,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"moderator_id","type":"uuid","description":"Moderator whose activity statistics are calculated. {@link reddit_like_moderators.id}.","relation":{"name":"moderator","targetModel":"reddit_like_moderators"},"unique":true,"nullable":false}],"plainFields":[{"name":"total_reports_reviewed","type":"int","description":"Total number of content reports this moderator has reviewed. Aggregated from reddit_like_moderation_actions where report_id is not null.","nullable":false},{"name":"total_content_removals","type":"int","description":"Total number of content removal actions taken by this moderator. Aggregated from reddit_like_moderation_actions where action_type='remove'.","nullable":false},{"name":"total_bans_issued","type":"int","description":"Total number of community bans issued by this moderator. Aggregated from reddit_like_community_bans.","nullable":false},{"name":"total_appeals_reviewed","type":"int","description":"Total number of appeals reviewed by this moderator. Aggregated from reddit_like_moderation_appeals where reviewer_moderator_id matches.","nullable":false},{"name":"average_report_response_hours","type":"double","description":"Average time in hours from report submission to moderator action. Calculated from time difference between report created_at and action created_at. Null if no reports reviewed.","nullable":true},{"name":"last_activity_at","type":"datetime","description":"Timestamp of the moderator's most recent moderation action. Used for identifying inactive moderators per R-LOG-014 (30 days threshold).","nullable":true},{"name":"last_calculated_at","type":"datetime","description":"Timestamp when this materialized view was last refreshed. Indicates data freshness.","nullable":false}],"uniqueIndexes":[{"fieldNames":["moderator_id"],"unique":true}],"plainIndexes":[{"fieldNames":["last_activity_at"]}],"ginIndexes":[]}]}]}
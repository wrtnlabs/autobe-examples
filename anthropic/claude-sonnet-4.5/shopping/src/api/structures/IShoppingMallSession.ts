import { tags } from "typia";

/**
 * Generic session information for detailed session view.
 *
 * Provides complete session information for detailed session inspection across
 * all user types (customer, seller, admin). Used when retrieving specific
 * session details by ID where comprehensive session data including device
 * information, location, activity tracking, and revocation status is needed.
 *
 * This type excludes the sensitive refresh_token field as it should never be
 * exposed in response DTOs except during initial authentication (IAuthorized
 * responses). The type includes all metadata necessary for security monitoring
 * and session management while maintaining token security.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type IShoppingMallSession = {
  /**
   * Unique identifier of the authentication session.
   *
   * This UUID serves as the primary key for the session record and is used
   * for session management operations such as revocation and detailed session
   * retrieval.
   */
  id: string & tags.Format<"uuid">;

  /**
   * Type of user this session belongs to.
   *
   * Discriminator field indicating whether this session belongs to a
   * customer, seller, or admin. Values: 'customer', 'seller', 'admin'. Used
   * to determine which user foreign key is populated.
   */
  user_type: string;

  /**
   * Expiration timestamp for the refresh token.
   *
   * Indicates when the refresh token will expire and can no longer be used to
   * generate new access tokens. Typically set to 30 days from session
   * creation. Sessions with expired refresh tokens require
   * re-authentication.
   */
  refresh_token_expires_at: string & tags.Format<"date-time">;

  /**
   * IP address from which the session was initiated.
   *
   * Records the user's IP address at login time for security monitoring,
   * fraud detection, and geographic analysis. Used to identify unusual login
   * locations and support suspicious activity alerts.
   */
  ip_address: string;

  /**
   * Detected device type from user agent parsing.
   *
   * Indicates whether the session originated from a mobile, tablet, or
   * desktop device. Parsed from the user agent string to provide
   * user-friendly device categorization in session management interfaces.
   */
  device_type?: string | null | undefined;

  /**
   * User-friendly device name for session display.
   *
   * Provides human-readable device description such as 'Chrome on Windows',
   * 'Safari on iPhone', or 'Firefox on Android'. Displayed in the active
   * sessions list to help identify which device each session represents.
   */
  device_name?: string | null | undefined;

  /**
   * Browser name parsed from user agent.
   *
   * Identifies the web browser used for this session such as Chrome, Firefox,
   * Safari, Edge, or other browsers. Useful for troubleshooting
   * browser-specific issues and understanding user technology preferences.
   */
  browser_name?: string | null | undefined;

  /**
   * Operating system parsed from user agent.
   *
   * Indicates the operating system of the device used for login such as
   * Windows, macOS, iOS, Android, or Linux. Provides additional device
   * context and helps identify potential security issues or compatibility
   * concerns.
   */
  operating_system?: string | null | undefined;

  /**
   * Approximate geographic location based on IP address.
   *
   * Derived from IP geolocation services, provides city and country
   * information such as 'New York, US' or 'London, UK'. Helps users identify
   * session locations and detect unauthorized access from unfamiliar
   * geographic areas.
   */
  approximate_location?: string | null | undefined;

  /**
   * Whether this session has been manually revoked.
   *
   * Indicates if the session has been terminated by the user or admin.
   * Revoked sessions cannot be used for token refresh and are effectively
   * logged out. When true, the session is no longer active.
   */
  is_revoked: boolean;

  /**
   * Timestamp when the session was revoked.
   *
   * Records the exact time when the session was manually terminated. Null if
   * the session is still active. Used for security auditing and session
   * lifecycle tracking.
   */
  revoked_at?: (string & tags.Format<"date-time">) | null | undefined;

  /**
   * Timestamp of the last activity in this session.
   *
   * Updated on each token refresh or important action. Used to track session
   * usage and enforce the 30-day inactivity timeout rule. Sessions with
   * last_activity_at older than 30 days are considered expired.
   */
  last_activity_at: string & tags.Format<"date-time">;

  /**
   * Timestamp when the session was created.
   *
   * Records when the user logged in and established this session. Used to
   * calculate session age and display login time in session management
   * interfaces.
   */
  created_at: string & tags.Format<"date-time">;
};

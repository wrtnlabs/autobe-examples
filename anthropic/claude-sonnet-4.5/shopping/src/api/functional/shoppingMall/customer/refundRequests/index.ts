import { IConnection, HttpError } from "@nestia/fetcher";
import { PlainFetcher } from "@nestia/fetcher/lib/PlainFetcher";
import typia, { tags } from "typia";
import { NestiaSimulator } from "@nestia/fetcher/lib/NestiaSimulator";

import { IShoppingMallRefundRequest } from "../../../../structures/IShoppingMallRefundRequest";

/**
 * Retrieve detailed information about a specific refund request.
 *
 * Retrieves comprehensive details about a specific refund request identified by
 * its unique ID from the shopping_mall_refund_requests table. This operation
 * provides complete visibility into the refund workflow including the original
 * order information, customer's refund reason and description, requested refund
 * amount, approved amount (if reviewed), current refund status, return
 * requirements, and tracking information.
 *
 * The refund request detail includes information about the requesting customer,
 * the associated order, the seller responsible for reviewing the request, and
 * any admin who may have overridden the decision. The response contains the
 * complete refund timeline with key timestamps including when the request was
 * submitted, the seller response deadline (3 business days from submission with
 * auto-approval if missed), when the request was reviewed, and when the refund
 * was completed.
 *
 * Security considerations include role-based access control where customers can
 * only view their own refund requests, sellers can view refund requests for
 * orders containing their products, and admins have full visibility across all
 * refund requests. The operation validates the refund request ID and ensures
 * the requesting user has appropriate permissions to access the refund request
 * details.
 *
 * This operation integrates with the order management system to provide order
 * context, the payment system to show refund processing status, and the review
 * workflow to display seller and admin responses. The refund request data helps
 * customers track their refund progress, enables sellers to make informed
 * approval decisions, and allows admins to resolve disputes and override
 * decisions when necessary.
 *
 * Related operations that might be used together include retrieving the
 * associated order details, viewing the order items that are being refunded,
 * and accessing the customer's refund request history for pattern analysis.
 *
 * @param props.connection
 * @param props.refundRequestId Unique identifier of the target refund request
 *   to retrieve
 * @path /shoppingMall/customer/refundRequests/:refundRequestId
 * @accessor api.functional.shoppingMall.customer.refundRequests.at
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export async function at(
  connection: IConnection,
  props: at.Props,
): Promise<at.Response> {
  return true === connection.simulate
    ? at.simulate(connection, props)
    : await PlainFetcher.fetch(
        {
          ...connection,
          headers: {
            ...connection.headers,
            "Content-Type": "application/json",
          },
        },
        {
          ...at.METADATA,
          path: at.path(props),
          status: null,
        },
      );
}
export namespace at {
  export type Props = {
    /** Unique identifier of the target refund request to retrieve */
    refundRequestId: string & tags.Format<"uuid">;
  };
  export type Response = IShoppingMallRefundRequest;

  export const METADATA = {
    method: "GET",
    path: "/shoppingMall/customer/refundRequests/:refundRequestId",
    request: null,
    response: {
      type: "application/json",
      encrypted: false,
    },
  } as const;

  export const path = (props: Props) =>
    `/shoppingMall/customer/refundRequests/${encodeURIComponent(props.refundRequestId ?? "null")}`;
  export const random = (): IShoppingMallRefundRequest =>
    typia.random<IShoppingMallRefundRequest>();
  export const simulate = (
    connection: IConnection,
    props: at.Props,
  ): Response => {
    const assert = NestiaSimulator.assert({
      method: METADATA.method,
      host: connection.host,
      path: at.path(props),
      contentType: "application/json",
    });
    try {
      assert.param("refundRequestId")(() =>
        typia.assert(props.refundRequestId),
      );
    } catch (exp) {
      if (!typia.is<HttpError>(exp)) throw exp;
      return {
        success: false,
        status: exp.status,
        headers: exp.headers,
        data: exp.toJSON().message,
      } as any;
    }
    return random();
  };
}
